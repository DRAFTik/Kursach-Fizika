###########################
# NWgeneric
###########################

add_namespace = NWgeneric

#Экономические связи с метрополией // субъект
country_event = {
	id = NWgeneric.1
	title = NWgeneric.1.t
	desc = NWgeneric.1.desc
	picture = GFX_report_event_generic_factory
	
	trigger = {
		has_idea = industrial_base
		is_subject = yes
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.1" }
	
	mean_time_to_happen = { months = 6 }
	
	option = {
		name = NWgeneric.1.a
		effect_tooltip = {
			OVERLORD = {
				random_owned_controlled_state = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
		}
		hidden_effect = {
			OVERLORD = { country_event = { id = NWgeneric.2 } }
		}
	}
}

#Экономические связи с метрополией // OVERLORD
country_event = {
	id = NWgeneric.2
	title = NWgeneric.2.t
	desc = NWgeneric.2.desc
	picture = GFX_report_event_generic_factory
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.2" }
	
	option = {
		name = NWgeneric.2.a
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = industrial_complex
					size > 0
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
}

#Военные связи с метрополией // субъект
country_event = {
	id = NWgeneric.3
	title = NWgeneric.3.t
	desc = NWgeneric.3.desc
	picture = GFX_report_event_saf_soldiers_2
	
	trigger = {
		has_idea = military_affairs
		is_subject = yes
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.3" }
	
	mean_time_to_happen = { months = 6 }
	
	option = {
		name = NWgeneric.3.a
		effect_tooltip = {
			OVERLORD = {
				add_manpower = 10000
			}
		}
		hidden_effect = {
			OVERLORD = { country_event = { id = NWgeneric.4 } }
		}
	}
}

#Экономические связи с метрополией // OVERLORD
country_event = {
	id = NWgeneric.4
	title = NWgeneric.4.t
	desc = NWgeneric.4.desc
	picture = GFX_report_event_saf_soldiers_2
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.4" }
	
	option = {
		name = NWgeneric.4.a
		add_manpower = 10000
	}
}

#Субъект проводит своевольную политику // OVERLORD
country_event = {
	id = NWgeneric.5
	title = NWgeneric.5.t
	desc = NWgeneric.5.desc
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.5" }
	
	option = {
		name = NWgeneric.5.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				FROM = { NOT = { has_completed_focus = seek_support } }
			}
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.5.a"
		if = {
			limit = { FROM = { has_completed_focus = seek_support } }
			FROM = { set_country_flag = start_seek_support_flag }
		}
	}
	
	option = {
		name = NWgeneric.5.b
		ai_chance = {
			factor = 50
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.5.b"
		FROM = {
			country_event = { id = NWgeneric.6 days = 1 }
			set_country_flag = NWgeneric5b_flag
		}
		custom_effect_tooltip = NWgeneric5b_tt
	}
	
	option = {
		name = NWgeneric.5.c
		ai_chance = {
			factor = 50
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.5.c"
		FROM = {
			country_event = { id = NWgeneric.6 days = 1 }
			set_country_flag = NWgeneric5c_flag
		}
		custom_effect_tooltip = NWgeneric5c_tt
	}
}

#Требование прекратить своевольную политику // SUBJECT
country_event = {
	id = NWgeneric.6
	title = NWgeneric.6.t
	desc = NWgeneric.6.desc
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.6" }
	
	option = {
		name = NWgeneric.6.a
		ai_chance = {
			factor = 50
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.6.a"
		if = {
			limit = { NOT = { has_completed_focus = seek_support } }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_free
				}
			}
			if = {
				limit = { is_in_faction = yes }
				leave_faction = yes
			}
			if = {
				limit = { has_war = yes }
				custom_effect_tooltip = root_out_of_all_war_tt
				hidden_effect = {
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
							NOT = {
								any_state = {
									is_owned_by = ROOT
									OR = {
										is_claimed_by = PREV
										is_core_of = PREV
									}
								}
								any_state = {
									is_owned_by = PREV
									OR = {
										is_claimed_by = ROOT
										is_core_of = ROOT
									}
								}
							}
						}
						white_peace = ROOT
					}
				}
			}
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
		else = { set_country_flag = start_seek_support_flag }
	}
	
	option = {
		name = NWgeneric.6.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				has_completed_focus = seek_support
			}
		}
		trigger = { has_country_flag = NWgeneric5b_flag }
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.6.b"
		clr_country_flag = NWgeneric5b_flag
		if = {
			limit = { has_autonomy_state = autonomy_colony }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_puppet
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_puppet }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_integrated_puppet
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_integrated_puppet }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_supervised_state
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_satellite }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_reichsprotectorate
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_reichsprotectorate }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_reichskommissariat
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_condominium }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_broresp
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_broresp }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_socprotect
				}
			}
		}
		else_if = {
			limit = { has_autonomy_state = autonomy_socprotect }
			OVERLORD = {
				set_autonomy = {
					target = ROOT
					autonomy_state = autonomy_marionet
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					has_autonomy_state = autonomy_reichskommissariat
					has_autonomy_state = autonomy_marionet
					has_autonomy_state = autonomy_supervised_state
				}
			}
			add_autonomy_score = {
				value = -100
			}
		}
	}
	
	option = {
		name = NWgeneric.6.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				has_completed_focus = seek_support
			}
		}
		trigger = { has_country_flag = NWgeneric5c_flag }
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.6.c"
		clr_country_flag = NWgeneric5c_flag
		OVERLORD = {
			set_autonomy = {
				target = ROOT
				autonomy_state = autonomy_dominion
			}
		}
		set_country_flag = autonomy_NWgeneric6_adopt
		custom_effect_tooltip = autonomy_NWgeneric6_adopt_tt
	}
}

#Субъект требует независимости // OVERLORD
country_event = {
	id = NWgeneric.7
	title = NWgeneric.7.t
	desc = NWgeneric.7.desc
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.7" }
	
	option = {
		name = NWgeneric.7.a
		ai_chance = {
			factor = 50
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.7.a"
		set_autonomy = {
			target = FROM
			autonomy_state = autonomy_free
		}
		FROM = {
			if = {
				limit = { is_in_faction = yes }
				leave_faction = yes
			}
			clear_gem_flag = yes
		}
		if = {
			limit = { FROM = { has_war = yes } }
			custom_effect_tooltip = from_out_of_all_war_tt
			hidden_effect = {
				FROM = {
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
							NOT = {
								any_state = {
									is_owned_by = FROM
									OR = {
										is_claimed_by = PREV
										is_core_of = PREV
									}
								}
								any_state = {
									is_owned_by = PREV
									OR = {
										is_claimed_by = FROM
										is_core_of = FROM
									}
								}
							}
						}
						white_peace = PREV
					}
				}
			}
		}
	}
	
	option = {
		name = NWgeneric.7.b
		ai_chance = {
			factor = 50
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.7.b"
		set_autonomy = {
			target = FROM
			autonomy_state = autonomy_free
		}
		FROM = {
			if = {
				limit = { is_in_faction = yes }
				leave_faction = yes
			}
			clear_gem_flag = yes
		}
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
		if = {
			limit = { FROM = { has_war = yes } }
			custom_effect_tooltip = from_out_of_all_war_tt
			hidden_effect = {
				FROM = {
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
							NOT = {
								any_state = {
									is_owned_by = FROM
									OR = {
										is_claimed_by = PREV
										is_core_of = PREV
									}
								}
								any_state = {
									is_owned_by = PREV
									OR = {
										is_claimed_by = FROM
										is_core_of = FROM
									}
								}
							}
						}
						white_peace = PREV
					}
				}
			}
		}
	}
}

#Другой субъект призывает к борьбе за независимость // SUBJECT
country_event = {
	id = NWgeneric.8
	title = NWgeneric.8.t
	desc = NWgeneric.8.desc
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.8" }
	
	option = {
		name = NWgeneric.8.a
		ai_chance = {
			factor = 30
			modifier = {
				add = 40
				FROM = { is_ai = no }
			}
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.8.a"
		set_country_flag = accept_call_to_fight_for_independence
		add_to_array = { FROM.country_array = this }
		custom_effect_tooltip = accept_call_to_fight_for_independence_tt
	}
	
	option = {
		name = NWgeneric.8.b
		ai_chance = {
			factor = 70
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.8.b"
		set_country_flag = declane_call_to_fight_for_independence
	}
}

#Ультиматум метрополии // OVERLORD
country_event = {
	id = NWgeneric.9
	title = NWgeneric.9.t
	desc = NWgeneric.9.desc
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.9" }
	
	option = {
		name = NWgeneric.9.a
		ai_chance = {
			factor = 40
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.9.a"
		set_autonomy = {
			target = FROM
			autonomy_state = autonomy_free
		}
		FROM = {
			if = {
				limit = { is_in_faction = yes }
				leave_faction = yes
			}
			clear_gem_flag = yes
		}
		if = {
			limit = { FROM = { has_war = yes } }
			custom_effect_tooltip = from_out_of_all_war_tt
			hidden_effect = {
				FROM = {
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
							NOT = {
								any_state = {
									is_owned_by = FROM
									OR = {
										is_claimed_by = PREV
										is_core_of = PREV
									}
								}
								any_state = {
									is_owned_by = PREV
									OR = {
										is_claimed_by = FROM
										is_core_of = FROM
									}
								}
							}
						}
						white_peace = PREV
					}
				}
			}
		}
		declare_war_on = {
			target = FROM
			type = annex_everything
		}
		hidden_effect = {
			every_other_country = {
				limit = {
					NOT = { tag = FROM }
					is_subject_of = ROOT
					has_country_flag = accept_call_to_fight_for_independence
				}
				OVERLORD = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_free
					}
				}
				clear_gem_flag = yes
				if = {
					limit = { is_in_faction = yes }
					leave_faction = yes
				}
				if = {
					limit = { has_war = yes }
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
						}
						white_peace = PREV
					}
				}
				add_to_war = {
					targeted_alliance = FROM
					enemy = ROOT 
					hostility_reason = asked_to_join
				}
			}
			every_country = {
				limit = {
					is_subject_of = ROOT
				}
				clr_country_flag = declane_call_to_fight_for_independence
			}
		}
		FROM = {
			clear_array = country_array
			clr_country_flag = start_seek_support_flag
		}
	}
	
	option = {
		name = NWgeneric.9.b
		ai_chance = {
			factor = 60
		}
		log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event choosen NWgeneric.9.b"
		set_autonomy = {
			target = FROM
			autonomy_state = autonomy_free
		}
		FROM = {
			if = {
				limit = { is_in_faction = yes }
				leave_faction = yes
			}
			clear_gem_flag = yes
			diplomatic_relation = {
				country = ROOT
				relation = non_aggression_pact
				active = yes
			}
		}
		diplomatic_relation = {
			country = FROM
			relation = non_aggression_pact
			active = yes
		}
		hidden_effect = {
			every_country = {
				limit = {
					is_subject_of = ROOT
				}
				clr_country_flag = accept_call_to_fight_for_independence
				clr_country_flag = declane_call_to_fight_for_independence
			}
		}
		if = {
			limit = { FROM = { has_war = yes } }
			custom_effect_tooltip = from_out_of_all_war_tt
			hidden_effect = {
				FROM = {
					every_enemy_country = {
						limit = {
							is_subject = no
							OR = { is_faction_leader = yes is_in_faction = no }
							NOT = {
								any_state = {
									is_owned_by = FROM
									OR = {
										is_claimed_by = PREV
										is_core_of = PREV
									}
								}
								any_state = {
									is_owned_by = PREV
									OR = {
										is_claimed_by = FROM
										is_core_of = FROM
									}
								}
							}
						}
						white_peace = PREV
					}
				}
			}
		}
		FROM = {
			clear_array = country_array
			clr_country_flag = start_seek_support_flag
		}
	}
}


#### РЕШЕНИЯ ####

#Правительство from организовало гражданскую войну
country_event = {
	id = NWgeneric.10
	title = NWgeneric.10.t
	desc = NWgeneric.10.desc
	picture = GFX_report_event_crowd_in_prague
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.10 from [From.GetName] ([From.GetTag])" }
	
	option = {
		name = NWgeneric.10.a
		add_opinion_modifier = { target = FROM modifier = generic_start_civil_war_op2 }
		FROM = { add_opinion_modifier = { target = ROOT modifier = generic_start_civil_war_op2 } }
	}
}

#Война кажется безнадёжной // осколок
country_event = {
	id = NWgeneric.11
	title = NWgeneric.11.t
	desc = NWgeneric.11.desc
	picture = GFX_report_event_chinese_soldiers_city_ruin
	
	trigger = {
		NOT = { has_country_flag = shard_call_to_help_flag }
		has_civil_war = yes
		any_other_country = {
			has_country_flag = flag_is_revolter_of_shard_@ROOT
			NOT = {
				is_in_faction_with = ROOT
				has_war_with = ROOT
				has_war_together_with = ROOT
			}
		}
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.11" }
	immediate = {
		hidden_effect = {
			set_country_flag = shard_call_to_help_flag
			random_other_country = {
				limit = {
					has_country_flag = flag_is_revolter_of_shard_@ROOT
				}
				save_event_target_as = is_revolter_of_shard_@ROOT
			}
		}
	}
	
	#mean_time_to_happen = { months = 3 }
	mean_time_to_happen = { days = 0 }
	
	option = {
		name = NWgeneric.11.a
		ai_chance = {
			factor = 90
		}
		event_target:is_revolter_of_shard_@ROOT = {
			country_event = { id = NWgeneric.12 days = 1 }
		}
	}
	
	option = {
		name = NWgeneric.11.b
		ai_chance = {
			factor = 0
		}
	}
}

#From запрашивает помощь // инициатор
country_event = {
	id = NWgeneric.12
	title = NWgeneric.12.t
	desc = NWgeneric.12.desc
	picture = GFX_report_event_bulgarian_soldiers
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.12 from [From.GetName] ([From.GetTag])" }
	immediate = {
		hidden_effect = {
			random_other_country = {
				limit = {
					has_country_flag = flag_revolter_of_base_is_@ROOT
				}
				save_event_target_as = revolter_of_base_is_@ROOT
			}
		}
	}

	option = {
		name = NWgeneric.12.a
		ai_chance = {
			factor = 90
		}
		declare_war_on = {
			target = event_target:revolter_of_base_is_@ROOT
			type = annex_everything
		}
	}
	
	option = {
		name = NWgeneric.12.b
		ai_chance = {
			factor = 10
		}
		add_ai_strategy = {
			type = alliance
			id = FROM		
			value = -100
		}
		add_ai_strategy = {
			type = protect
			id = FROM		
			value = -100
		}
		add_ai_strategy = {
			type = send_volunteers_desire
			id = FROM		
			value = -75
		}
		remove_opinion_modifier = { target = FROM modifier = generic_start_civil_war_op }
		FROM = {
			remove_opinion_modifier = { target = ROOT modifier = generic_start_civil_war_op }
			add_opinion_modifier = { target = ROOT modifier = generic_no_support_in_civil_war_op }
			add_ai_strategy = {
				type = befriend
				id = ROOT
				value = -150
			}
			add_ai_strategy = {
				type = alliance
				id = ROOT		
				value = -300
			}
		}
	}
}

#Государство должно заплатить за свои преступления // выжившая цель
country_event = {
	id = NWgeneric.13
	title = NWgeneric.13.t
	desc = NWgeneric.13.desc
	picture = GFX_report_event_communist_leader
	
	trigger = {
		has_civil_war = no
		any_other_country = {
			has_country_flag = flag_is_revolter_of_base_@ROOT
			NOT = {
				is_in_faction_with = ROOT
				has_war_with = ROOT
			}
			ROOT = { has_country_flag = flag_revolter_of_base_is_@PREV }
		}
		NOT = { has_country_flag = has_chance_revenge_flag }
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.13" }
	immediate = {
		hidden_effect = {
			set_country_flag = has_chance_revenge_flag
			random_other_country = {
				limit = {
					has_country_flag = flag_is_revolter_of_base_@ROOT
				}
				save_event_target_as = target_to_revenge_from_@ROOT
			}
		}
	}
	
	mean_time_to_happen = { days = 10 }
	
	option = {
		name = NWgeneric.13.a
		ai_chance = {
			factor = 90
		}
		create_wargoal = {
			type = annex_everything
			target = event_target:target_to_revenge_from_@ROOT
		}
		add_ai_strategy = {
			type = antagonize
			id = event_target:target_to_revenge_from_@ROOT
			value = 100
		}
		add_ai_strategy = {
			type = conquer
			id = event_target:target_to_revenge_from_@ROOT
			value = 100
		}
	}
	
	option = {
		name = NWgeneric.13.b
		ai_chance = {
			factor = 10
		}
	}
}



#Анархист приглашает в альянс
country_event = {
	id = NWgeneric.14
	title = NWgeneric.14.t
	desc = NWgeneric.14.desc
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NWgeneric.14" }
	
	option = {
		name = NWgeneric.14.a
		ai_chance = {
			factor = 50
			modifier = {
				add = 20
				FROM = { original_tag = ETH }
				has_country_flag = anarchism_neutrality_flag
			}
			modifier = {
				factor = 10
				FROM = {
					NOT = { original_tag = ETH }
					has_country_flag = anarchism_neutrality_flag
				}
				has_country_flag = anarchism_neutrality_flag
			}
			modifier = {
				factor = 10
				FROM = {
					NOT = { original_tag = ETH }
					has_country_flag = anarchism_left_flag
				}
				has_country_flag = anarchism_left_flag
			}
			modifier = {
				factor = 10
				FROM = {
					NOT = { original_tag = ETH }
					has_country_flag = anarchism_right_flag
				}
				has_country_flag = anarchism_right_flag
			}
		}
		FROM = {
			add_to_faction = ROOT
			country_event = { id = generic.6 hours = 6 } 
		}
	}
	
	option = {
		name = NWgeneric.14.b
		ai_chance = {
			factor = 50
			modifier = {
				add = -20
				FROM = { original_tag = ETH }
				has_country_flag = anarchism_neutrality_flag
			}
		}
		FROM = { country_event = { id = generic.7 hours = 6 } }
	}
}



#TEST
country_event = {
	id = NWgeneric.999
	title = TEST
	desc = TEST
	picture = GFX_report_event_generic_rally_3
	is_triggered_only = yes
	
	option = {
		name = 1
		FRA = { drop_cosmetic_tag = yes }
	}
	
	option = {
		name = 2
		FRA = {
			create_country_leader = {
				name = "Annet de La Rocque"
				desc = "POLITICS_ANNET_DE_LA_ROCQUE_DESC"
				picture = "gfx/leaders/FRA/Portrait_Annet_de_La_Rocque.dds"
				expire = "1965.1.1"
				ideology = centrism
				traits = {
				}
			}
		}
	}
	
}

