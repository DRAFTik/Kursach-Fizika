add_namespace = resistance
add_namespace = rm_news

# Основано сопротивление
country_event = {
	id = resistance.1
	title = resistance.1.t
	desc = resistance.1.d
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.1" }
	
	option = {
		name = resistance.1.a
	}
}

# Удар Сопротивления! - неудача
country_event = {
	id = resistance.2
	title = { text = resistance.2.t.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	desc = { text = resistance.2.d.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	title = { text = resistance.2.t.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	desc = { text = resistance.2.d.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	title = { text = resistance.2.t.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	desc = { text = resistance.2.d.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	title = { text = resistance.2.t.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	desc = { text = resistance.2.d.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	title = { text = resistance.2.t.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	desc = { text = resistance.2.d.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	title = { text = resistance.2.t.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	desc = { text = resistance.2.d.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	title = { text = resistance.2.t.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	desc = { text = resistance.2.d.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	title = { text = resistance.2.t.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	desc = { text = resistance.2.d.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	title = { text = resistance.2.t.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	desc = { text = resistance.2.d.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	title = { text = resistance.2.t.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	desc = { text = resistance.2.d.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	title = { text = resistance.2.t.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	desc = { text = resistance.2.d.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.2"		
		hidden_effect = { clr_flags = yes }
	}
	
	option = {
		name = resistance.2.a
		
		custom_effect_tooltip = failed_rebels_tt
		hidden_effect = { FROM = { country_event = { id = resistance.19 } } }
	}
}

# Удар Сопротивления! - удача и не совсем
country_event = {
	id = resistance.3
	title = { text = resistance.3.t.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	desc = { text = resistance.3.d.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	title = { text = resistance.3.t.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	desc = { text = resistance.3.d.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	title = { text = resistance.3.t.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	desc = { text = resistance.3.d.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	title = { text = resistance.3.t.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	desc = { text = resistance.3.d.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	title = { text = resistance.3.t.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	desc = { text = resistance.3.d.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	title = { text = resistance.3.t.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	desc = { text = resistance.3.d.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	title = { text = resistance.3.t.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	desc = { text = resistance.3.d.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	title = { text = resistance.3.t.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	desc = { text = resistance.3.d.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	title = { text = resistance.3.t.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	desc = { text = resistance.3.d.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	title = { text = resistance.3.t.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	desc = { text = resistance.3.d.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	title = { text = resistance.3.t.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	desc = { text = resistance.3.d.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.3"
		hidden_effect = { clr_flags = yes }
	}
	
	option = {
		name = resistance.3.a
		attack_to = yes
		custom_effect_tooltip = failed_rebels_tt
		hidden_effect = { FROM = { country_event = { id = resistance.20 } } }
	}
}

# Удар Сопротивления! - удача
country_event = {
	id = resistance.4
	title = { text = resistance.3.t.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	desc = { text = resistance.3.d.infrastructure trigger = { FROM = { has_country_flag = strike_to_infrastructure } } }
	title = { text = resistance.3.t.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	desc = { text = resistance.3.d.dockyard trigger = { FROM = { has_country_flag = strike_to_dockyard } } }
	title = { text = resistance.3.t.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	desc = { text = resistance.3.d.arms_factory trigger = { FROM = { has_country_flag = strike_to_arms_factory } } }
	title = { text = resistance.3.t.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	desc = { text = resistance.3.d.industrial_complex trigger = { FROM = { has_country_flag = strike_to_industrial_complex } } }
	title = { text = resistance.3.t.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	desc = { text = resistance.3.d.aviabase trigger = { FROM = { has_country_flag = strike_to_aviabase } } }
	title = { text = resistance.3.t.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	desc = { text = resistance.3.d.nuclear trigger = { FROM = { has_country_flag = strike_to_nuclear } } }
	title = { text = resistance.3.t.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	desc = { text = resistance.3.d.anti_air_building trigger = { FROM = { has_country_flag = strike_to_anti_air_building } } }
	title = { text = resistance.3.t.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	desc = { text = resistance.3.d.synthetic_refinery trigger = { FROM = { has_country_flag = strike_to_synthetic_refinery } } }
	title = { text = resistance.3.t.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	desc = { text = resistance.3.d.fuel_silo trigger = { FROM = { has_country_flag = strike_to_fuel_silo } } }
	title = { text = resistance.3.t.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	desc = { text = resistance.3.d.radar_station trigger = { FROM = { has_country_flag = strike_to_radar_station } } }
	title = { text = resistance.3.t.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	desc = { text = resistance.3.d.rocket_site trigger = { FROM = { has_country_flag = strike_to_rocket_site } } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.4"
		hidden_effect = { clr_flags = yes }
	}
	
	option = {
		name = resistance.4.a
		attack_to = yes
		hidden_effect = { FROM = { country_event = { id = resistance.21 } } }
	}
}

# Расформирование дивизий
country_event = {
	id = resistance.5
	
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.5" 
		
		add_to_variable = { var = rebel_manpower@ROOT value = 6600 }
		add_to_variable = { var = rebel_infantry_equipment@ROOT value = 610 }
		add_to_variable = { var = rebel_support_equipment@ROOT value = 30 }
		add_to_variable = { var = rebel_artillery_equipment@ROOT value = 12 }
		
		if = {
			limit = { ROOT = { check_variable = { num_division@ROOT > 0 } } }
			subtract_from_variable = { var = num_division@ROOT value = 1 }
		}
		else_if = {
			limit = { ROOT = { check_variable = { num_division_trained_1@ROOT > 0 } } }
			subtract_from_variable = { var = num_division_trained_1@ROOT value = 1 }
		}
		else_if = {
			limit = { ROOT = { check_variable = { num_division_trained_2@ROOT > 0 } } }
			subtract_from_variable = { var = num_division_trained_2@ROOT value = 1 }
		}
		
		if = {
			limit = { 
				OR = {
					check_variable = { num_division@ROOT > 0 } 
					check_variable = { num_division_trained_1@ROOT > 0 } 
					check_variable = { num_division_trained_2@ROOT > 0 } 
				}
			}
			country_event = { id = resistance.5 }
		}
	}
}

# Расформирование малых дивизий
country_event = {
	id = resistance.6
	
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.6" 
		
		add_to_variable = { var = rebel_manpower@ROOT value = 4000 }
		add_to_variable = { var = rebel_infantry_equipment@ROOT value = 400 }
		
		if = {
			limit = { ROOT = { check_variable = { num_small_division@ROOT > 0 } } }
			subtract_from_variable = { var = num_small_division@ROOT value = 1 }
		}
		else_if = {
			limit = { ROOT = { check_variable = { num_small_division_trained_1@ROOT > 0 } } }
			subtract_from_variable = { var = num_small_division_trained_1@ROOT value = 1 }
		}
		else_if = {
			limit = { ROOT = { check_variable = { num_small_division_trained_2@ROOT > 0 } } }
			subtract_from_variable = { var = num_small_division_trained_2@ROOT value = 1 }
		}
		
		if = {
			limit = { 
				OR = { 
					check_variable = { num_small_division@ROOT > 0 } 
					check_variable = { num_small_division_trained_1@ROOT > 0 } 
					check_variable = { num_small_division_trained_2@ROOT > 0 } 
				}
			}
			country_event = { id = resistance.6 }
		}
	}
}

# Расстановка дивизий
country_event = {
	id = resistance.7
	
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event resistance.7 [?num_division@ROOT]" 
		
		if = {
			limit = {
				original_tag = POL
				NOT = { has_country_flag = set_to_warszawa }
				10 = { is_owned_by = ROOT }
				10 = { NOT = { is_controlled_by = ROOT } }
			}
			10 = {
				set_state_flag = general_resistance
				ROOT = { set_state_controller = PREV }
			}
			if = {
				limit = { has_template = "Dywizja Armii Krajowej" }
				load_oob = "POL_AK_Warszawa"
			}
			else_if = {
				limit = { has_template = "Dywizja Armii Ludowej" }
				load_oob = "POL_AL_Warszawa"
			}
			set_country_flag = set_to_warszawa
		}
		else = {
			random_state = {
				limit = { 
					is_owned_by = ROOT
					is_core_of = ROOT
					OR = {
						NOT = { is_controlled_by = ROOT }
						has_state_flag = general_resistance
					}
				}
				set_state_flag = general_resistance
				ROOT = { set_state_controller = PREV }
				if = {
					limit = { ROOT = { has_template = "Rebel Division" } }
					if = {
						limit = { ROOT = { check_variable = { num_division_trained_2@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_2@ROOT value = 1 } }
						create_unit = { division = "name = \"Rebel Division\" division_template = \"Rebel Division\" start_experience_factor = 0.4" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division_trained_1@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_1@ROOT value = 1 } }
						create_unit = { division = "name = \"Rebel Division\" division_template = \"Rebel Division\" start_experience_factor = 0.2" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division@ROOT value = 1 } }
						create_unit = { division = "name = \"Rebel Division\" division_template = \"Rebel Division\" start_experience_factor = 0.05" owner = ROOT }
					}
				}
				else_if = {
					limit = { ROOT = { has_template = "Dywizja Armii Krajowej" } }
					if = {
						limit = { ROOT = { check_variable = { num_division_trained_2@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_2@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Dywizja Armii Krajowej\" start_experience_factor = 0.4" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division_trained_1@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_1@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Dywizja Armii Krajowej\" start_experience_factor = 0.2" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Dywizja Armii Krajowej\" start_experience_factor = 0.05" owner = ROOT }
					}
				}
				else_if = {
					limit = { ROOT = { has_template = "Dywizja Armii Ludowej" } }
					log = "[GetDateText]: [Root.GetName]: event resistance.7 AK" 
					if = {
						limit = { ROOT = { check_variable = { num_division_trained_2@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_2@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Ludowej\" division_template = \"Dywizja Armii Ludowej\" start_experience_factor = 0.4" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division_trained_1@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division_trained_1@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Ludowej\" division_template = \"Dywizja Armii Ludowej\" start_experience_factor = 0.2" owner = ROOT }
					}
					else_if = {
						limit = { ROOT = { check_variable = { num_division@ROOT > 0 } } }
						OWNER = { subtract_from_variable = { var = num_division@ROOT value = 1 } }
						create_unit = { division = "name = \"Dywizja Armii Ludowej\" division_template = \"Dywizja Armii Ludowej\" start_experience_factor = 0.05" owner = ROOT }
					}
				}
			}
		}
		
		if = {
			limit = { 
				OR = {
					check_variable = { num_division@ROOT > 0 } 
					check_variable = { num_division_trained_1@ROOT > 0 } 
					check_variable = { num_division_trained_2@ROOT > 0 } 
				}
			}
			country_event = { id = resistance.7 }
		}
	}
}

# Расстановка малых дивизий
country_event = {
	id = resistance.8
	
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event resistance.8" 
		
		random_state = {
			limit = { 
				is_owned_by = ROOT
				is_core_of = ROOT
				OR = {
					NOT = { is_controlled_by = ROOT }
					has_state_flag = general_resistance
				}
			}
			set_state_flag = general_resistance
			ROOT = { set_state_controller = PREV }
			if = {
				limit = { ROOT = { has_template = "Light Rebel Division" } }
				if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_2@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_2@ROOT value = 1 } }
					create_unit = { division = "name = \"Light Rebel Division\" division_template = \"Light Rebel Division\" start_experience_factor = 0.4" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_1@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_1@ROOT value = 1 } }
					create_unit = { division = "name = \"Light Rebel Division\" division_template = \"Light Rebel Division\" start_experience_factor = 0.2" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division@ROOT value = 1 } }
					create_unit = { division = "name = \"Light Rebel Division\" division_template = \"Light Rebel Division\" start_experience_factor = 0.05" owner = ROOT }
				}
			}
			else_if = {
				limit = { ROOT = { has_template = "Lekka Dywizja Armii Krajowej" } }
				if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_2@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_2@ROOT value = 1 } }
					create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Lekka Dywizja Armii Krajowej\" start_experience_factor = 0.4" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_1@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_1@ROOT value = 1 } }
					create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Lekka Dywizja Armii Krajowej\" start_experience_factor = 0.2" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division@ROOT value = 1 } }
					create_unit = { division = "name = \"Dywizja Armii Krajowej\" division_template = \"Lekka Dywizja Armii Krajowej\" start_experience_factor = 0.05" owner = ROOT }
				}
			}
			else_if = {
				limit = { ROOT = { has_template = "Lekka Dywizja Armii Ludowej" } }
				if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_2@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_2@ROOT value = 1 } }
					create_unit = { division = "name = \"Lekka Dywizja Armii Ludowej\" division_template = \"Lekka Dywizja Armii Ludowej\" start_experience_factor = 0.4" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division_trained_1@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division_trained_1@ROOT value = 1 } }
					create_unit = { division = "name = \"Lekka Dywizja Armii Ludowej\" division_template = \"Lekka Dywizja Armii Ludowej\" start_experience_factor = 0.2" owner = ROOT }
				}
				else_if = {
					limit = { ROOT = { check_variable = { num_small_division@ROOT > 0 } } }
					OWNER = { subtract_from_variable = { var = num_small_division@ROOT value = 1 } }
					create_unit = { division = "name = \"Lekka Dywizja Armii Ludowej\" division_template = \"Lekka Dywizja Armii Ludowej\" start_experience_factor = 0.05" owner = ROOT }
				}
			}
		}
		
		if = {
			limit = { 
				OR = {
					check_variable = { num_small_division@ROOT > 0 } 
					check_variable = { num_small_division_trained_1@ROOT > 0 } 
					check_variable = { num_small_division_trained_2@ROOT > 0 } 
				}
			}
			country_event = { id = resistance.8 }
		}
	}
}

# Восстание проиграно
country_event = {
	id = resistance.9
	title = resistance.9.t
	desc = resistance.9.d
	
	fire_only_once = yes

	mean_time_to_happen = {
		days = 7
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.9" }
	
	trigger = {
		has_country_flag = baptized_in_fire
		NOT = {
			any_state = {
				has_state_flag = general_resistance
				is_owned_by = ROOT
				is_controlled_by = ROOT
			}
		}
	}
	
	option = {
		name = resistance.9.a
		
		add_political_power = -80
		add_legitimacy = -20
		add_timed_idea = {
			idea = resistance_failed
			days = 365
		}
		hidden_effect = {
			clr_country_flag = baptized_in_fire
			every_state = {
				limit = {
					has_state_flag = general_resistance
					is_owned_by = ROOT
				}
				clr_state_flag = general_resistance
			}
		}
		if = {
			limit = { original_tag = POL owns_state = 10 has_global_flag = POL_powstanie_warszawskie }
			news_event = { id = rm_news.4 days = 1 }
		}
	}
}

# Бонусы?
country_event = {
	id = resistance.10
	title = resistance.10.t
	desc = resistance.10.d
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.10" }
	
	option = {
		name = resistance.10.a
		ai_chance = { factor = 100 }
		
		if = { 
			limit = { has_country_flag = resistance10a }
			
			add_political_power = -20
		}
		else = {
			add_political_power = -40
			add_tech_bonus = {
				bonus = 1.0
				uses = 1
				category = decryption_tech
			}
		}
		
		set_country_flag = resistance10a
		hidden_effect = { FROM = { country_event = { id = resistance.11 } } }
	}
	
	option = {
		name = resistance.10.b
		ai_chance = { factor = 0 }
		
		add_political_power = 10
		hidden_effect = { FROM = { country_event = { id = resistance.12 } } }
	}
}

# Бонусы!
country_event = {
	id = resistance.11
	title = resistance.11.t
	desc = resistance.11.d
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.11" }
	
	option = {
		name = resistance.11.a
		
		add_tech_bonus = {
			bonus = 3.0
			uses = 1
			category = decryption_tech
		}				
	}
}

# Бонусов нет
country_event = {
	id = resistance.12
	title = resistance.12.t
	desc = resistance.12.d
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.12" }
	
	option = {
		name = resistance.12.a
		
		add_opinion_modifier = { target = FROM modifier = opinion_denied_us_the_exchange_of_technology }
	}
}

# Нападение на вражеского офицера - не успех
country_event = {
	id = resistance.13
	title = resistance.13.t
	desc = resistance.13.d
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.13" 
	}
	
	option = {
		name = resistance.13.a
		
		hidden_effect = { FROM = { country_event = { id = resistance.18 } } }
	}
}

# Нападение на вражеского офицера - успех с потерями
country_event = {
	id = resistance.14
	title = { text = resistance.14.t trigger = { NOT = { has_country_flag = i_kill_you } } }
	desc = { text = resistance.14.d trigger = { NOT = { has_country_flag = i_kill_you } } }
	title = { text = resistance.14.tkill trigger = { has_country_flag = i_kill_you } }
	desc = { text = resistance.14.dkill trigger = { has_country_flag = i_kill_you } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.14" 
		OFFICER_KILL = yes
	}
	
	option = {
		name = resistance.14.a
		
		if = {
			limit = {
				has_country_flag = i_kill_you
			}
			effect_tooltip = { 
				random_unit_leader = {
					limit = {
						NOT = {
							has_id = 19810
							has_id = 19811
						}
					}
					retire = yes
					set_unit_leader_flag = transfer_to_sai
				}
			}
			
			hidden_effect = { 
				random_unit_leader = {
					limit = {
						has_unit_leader_flag = transfer_to_sai
					}
					clr_unit_leader_flag = transfer_to_sai
					set_nationality = SAI
				}
				FROM = { country_event = { id = resistance.17 } } 
			}
			
		}
		else = {
			hidden_effect = { FROM = { country_event = { id = resistance.17 } } } 
		}
		
		army_experience = del_exp@ROOT
	}
}

# Нападение на вражеского офицера - успех без потерь
country_event = {
	id = resistance.15
	title = { text = resistance.15.t trigger = { NOT = { has_country_flag = i_kill_you } } }
	desc = { text = resistance.15.d trigger = { NOT = { has_country_flag = i_kill_you } } }
	title = { text = resistance.15.tkill trigger = { has_country_flag = i_kill_you } }
	desc = { text = resistance.15.dkill trigger = { has_country_flag = i_kill_you } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.15" 
		OFFICER_KILL = yes
	}
	
	option = {
		name = resistance.15.a
		
		if = {
			limit = {
				has_country_flag = i_kill_you
			}
			effect_tooltip = { 
				random_unit_leader = {
					limit = {
						NOT = {
							has_id = 19810
							has_id = 19811
						}
					}
					retire = yes
					set_unit_leader_flag = transfer_to_sai
				}
			}
			
			hidden_effect = { 
				random_unit_leader = {
					limit = {
						has_unit_leader_flag = transfer_to_sai
					}
					clr_unit_leader_flag = transfer_to_sai
					set_nationality = SAI
				}
				FROM = { country_event = { id = resistance.16 } } 
			}
			
		}
		else = {
			hidden_effect = { FROM = { country_event = { id = resistance.17 } } } 
		}
		
		army_experience = del_exp@ROOT
	}
}

country_event = {
	id = resistance.16
	title = { text = resistance.16.t trigger = { NOT = { FROM = { has_country_flag = i_kill_you } } } }
	desc = { text = resistance.16.d trigger = { NOT = { FROM = { has_country_flag = i_kill_you } } } }
	title = { text = resistance.16.tkill trigger = { FROM = { has_country_flag = i_kill_you } } }
	desc = { text = resistance.16.dkill trigger = { FROM = { has_country_flag = i_kill_you } } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.16" 
	}
	
	option = {
		name = resistance.16.a
		
		if = {
			limit = { FROM = { has_country_flag = i_kill_you } }
			FROM = { clr_country_flag = i_kill_you }
			
			add_political_power = 80
		}
	}
}

country_event = {
	id = resistance.17
	title = { text = resistance.17.t trigger = { NOT = { FROM = { has_country_flag = i_kill_you } } } }
	desc = { text = resistance.17.d trigger = { NOT = { FROM = { has_country_flag = i_kill_you } } } }
	title = { text = resistance.17.tkill trigger = { FROM = { has_country_flag = i_kill_you } } }
	desc = { text = resistance.17.dkill trigger = { FROM = { has_country_flag = i_kill_you } } }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.17" 
		hidden_effect = {
			random_list = {
				2 = { set_country_flag = losses_1 }
				5 = { set_country_flag = losses_2 }
				10 = { set_country_flag = losses_3 }
				15 = { set_country_flag = losses_4 }
				25 = { set_country_flag = losses_5 }
			}
		}
	}
	
	option = {
		name = resistance.17.a
		
		clr_losses = yes
		
		if = {
			limit = { FROM = { has_country_flag = i_kill_you } }
			FROM = { clr_country_flag = i_kill_you }
			
			add_political_power = 60
		}
	}
}

country_event = {
	id = resistance.18
	title = resistance.18.t
	desc = resistance.18.d
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.18" 
		hidden_effect = {
			random_list = {
				1 = { set_country_flag = losses_1 }
				5 = { set_country_flag = losses_2 }
				10 = { set_country_flag = losses_3 }
				15 = { set_country_flag = losses_4 }
				25 = { set_country_flag = losses_5 }
			}
		}
	}
	
	option = {
		name = resistance.18.a
		
		clr_losses = yes
	}
}

# Удар Сопротивления! - NIEудача
country_event = {
	id = resistance.19
	title = { text = resistance.19.t }
	desc = { text = resistance.19.d }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.19"
		hidden_effect = {
			random_list = {
				2 = { set_country_flag = losses_1 }
				5 = { set_country_flag = losses_2 }
				10 = { set_country_flag = losses_3 }
				15 = { set_country_flag = losses_4 }
				25 = { set_country_flag = losses_5 }
			}
		}
	}
	
	option = {
		name = resistance.19.a
		
		clr_losses = yes
		add_political_power = -20
	}
}

# Удар Сопротивления! - удача 50/50
country_event = {
	id = resistance.20
	title = { text = resistance.20.t }
	desc = { text = resistance.20.d }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.20"
		hidden_effect = {
			random_list = {
				2 = { set_country_flag = losses_1 }
				5 = { set_country_flag = losses_2 }
				10 = { set_country_flag = losses_3 }
				15 = { set_country_flag = losses_4 }
				25 = { set_country_flag = losses_5 }
			}
		}
	}
	
	option = {
		name = resistance.20.a
		
		clr_losses = yes
	}
}

# Удар Сопротивления! - удача
country_event = {
	id = resistance.21
	title = { text = resistance.21.t }
	desc = { text = resistance.21.d }
	
	is_triggered_only = yes
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.21"
	}
	
	option = {
		name = resistance.21.a
		
		add_political_power = 20
	}
}

# Завершение войны
country_event = {
	id = resistance.22
	
	trigger = {
		has_war = no
		has_country_flag = Form_rebel_army
	}
	
	hidden = yes
	
	mean_time_to_happen = { days = 14 }
	
	immediate = { 
		log = "[GetDateText]: [Root.GetName]: event resistance.22"
		
		ROOT = { clr_country_flag = Form_rebel_army }
	}
}


 #                        ↓ Проход для белых ходоков  #                                           #                                    #
################              ##########################################################################################################
##################          #############################################################################################################
###################       ################################################################################################################

# Варшавское восстание!
country_event = {
	id = resistance.44
	title = resistance.44.t
	desc = resistance.44.d
	picture = GFX_report_event_generic_rally_3
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.44" }
	
	option = {
		name = resistance.44.a
		trigger = {
			NOT = {
				has_government = communism
				has_government = trozkism
			}
		}
		
		add_timed_idea = {
			idea = POL_czas_w
			days = 90
		}
		news_event = { id = rm_news.2 days = 1 }
		set_global_flag = POL_powstanie_warszawskie
	}
	
	option = {
		name = resistance.44.b
		trigger = {
			OR = {
				has_government = communism
				has_government = trozkism
			}
		}
		
		add_timed_idea = {
			idea = POL_czas_w
			days = 90
		}
		news_event = { id = rm_news.3 days = 1 }
		set_global_flag = POL_powstanie_warszawskie
	}
}

# Варшава пала!
country_event = {
	id = resistance.45
	title = resistance.45.t
	desc = resistance.45.d
	
	fire_only_once = yes

	mean_time_to_happen = { days = 1 }
	
	trigger = {
		has_global_flag = POL_powstanie_warszawskie
		NOT = { has_country_flag = dayVinWarszawa }
		10 = {
			has_state_flag = general_resistance
			is_owned_by = ROOT
			NOT = { is_controlled_by = ROOT }
		}
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.45" }
	
	option = {
		name = resistance.45.a
		
		# remove_ideas = POL_czas_w
		# news_event = { id = rm_news.4 days = 1 }
		add_stability = -0.1
		10 = {
			remove_building = {
				type = infrastructure
				level = 2
			}
			add_manpower = -68000
		}
		hidden_effect = { 
			10 = { controller = { set_country_flag = prawo_msci } }
		}
	}
}

# Восстановление Варшавы
country_event = {
	id = resistance.46
	title = resistance.46.t
	desc = resistance.46.d
	
	fire_only_once = yes

	mean_time_to_happen = {
		days = 7
	}
	
	trigger = {
		original_tag = POL
		10 = { is_fully_controlled_by = POL has_state_flag = fallen_city  }
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.46" }
	
	# Yes, we can!
	option = {
		name = resistance.46.a
		ai_chance = { factor = 100 }
		
		activate_decision = rebuild_warszawa
		# custom_effect_tooltip = my_tooltip_tt
		country_event = { id = resistance.47 }
	}
	
	# No
	option = {
		name = resistance.46.b
		ai_chance = { factor = 0 }
		add_stability = -0.05
		country_event = { id = resistance.47 }
	}
}

# Выбор временной столицы (или нет...)
country_event = {
	id = resistance.47
	title = resistance.47.t
	desc = { text = resistance.47.d.1 trigger = { has_country_flag = POL_active_decision } }
	desc = { text = resistance.47.d.2 trigger = { NOT = { has_country_flag = POL_active_decision } } }
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.47" }
	
	# Лодзь!
	option = {
		name = resistance.47.lodz
		trigger = { 
			87 = { is_owned_by = POL }
		}
		ai_chance = { 
			factor = 10 
			modifier = {
				NOT = { controls_state = 87 }
				factor = 1
			}
			modifier = {
				is_historical_focus_on = yes
				factor = 100
			}
		}
		
		set_capital = 87
	}
	
	# Краков
	option = {
		name = resistance.47.krakow
		trigger = { 
			88 = { is_owned_by = POL }
		}
		ai_chance = { 
			factor = 10 
			modifier = {
				NOT = { controls_state = 88 }
				factor = 1
			}
		}
		
		set_capital = 88
	}
	
	# Люблин
	option = {
		name = resistance.47.lublin
		trigger = { 
			92 = { is_owned_by = POL }
		}
		ai_chance = { 
			factor = 10 
			modifier = {
				NOT = { controls_state = 92 }
				factor = 1
			}
		}
		
		set_capital = 92
	}
	
	# Плоцк
	option = {
		name = resistance.47.plock
		trigger = { 
			98 = { is_owned_by = POL }
		}
		ai_chance = { 
			factor = 10 
			modifier = {
				NOT = { controls_state = 98 }
				factor = 1
			}
		}
		
		set_capital = 98
	}
}

# Варшава восстановлена
country_event = {
	id = resistance.48
	title = resistance.48.t
	desc = resistance.48.d
	
	fire_only_once = yes

	mean_time_to_happen = {
		days = 7
	}
	
	trigger = {
		10 = { 
			has_state_flag = fallen_city 
			is_owned_and_controlled_by = ROOT
			infrastructure > 7
		}
	}
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.47" }
	
	option = {
		name = resistance.48.a
		
		10 = {
			clr_state_flag = fallen_city
			set_state_category = large_city
		}
		reset_province_name = 3544
	}
}

# Дебафф при столице
country_event = {
	id = resistance.49
	immediate = {log = "[GetDateText]: [Root.GetName]: event rename.49"}
	
	trigger = {
		original_tag = POL
		10 = { 
			is_capital = yes 
			has_state_flag = fallen_city
		}
		NOT = { has_idea = POL_defeat_capital } 
	}
	
	hidden = yes mean_time_to_happen = { days = 3 }
	
	option = { 
		ROOT = { add_ideas = POL_defeat_capital }
	}
}

# Возвращение убитых генералов
country_event = {
	id = resistance.100
	title = resistance.100.t
	desc = resistance.100.d
	
	is_triggered_only = yes
	
	immediate = { log = "[GetDateText]: [Root.GetName]: event resistance.100" }
	
	option = {
		name = resistance.100.a
	}
}

news_event = {
	id = rm_news.1
	title = rm_news.1.t
	desc = rm_news.1.d
	picture = GFX_news_event_ger_civil_war
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = rm_news.1.a
		trigger = {
			NOT = {
				TAG = FROM
				all_country = {
					has_war_with = FROM
				}
			}
		}
	}
	option = {
		name = rm_news.1.b
		trigger = { TAG = FROM }
	}
	option = {
		name = rm_news.1.c
		trigger = { 
			all_country = { 
				has_war_with = FROM
			}
		}
	}
}

news_event = {
	id = rm_news.2
	title = rm_news.2.t
	desc = rm_news.2.d
	picture = GFX_news_event_polish_resistance_warsaw
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = rm_news.2.a
		trigger = {
			NOT = {
				TAG = FROM
				all_country = {
					has_war_with = FROM
				}
			}
		}
	}
	option = {
		name = rm_news.2.b
		trigger = { TAG = FROM }
	}
	option = {
		name = rm_news.2.c
		trigger = { 
			all_country = { 
				has_war_with = FROM
			}
		}
	}
}

news_event = {
	id = rm_news.3
	title = rm_news.3.t
	desc = rm_news.3.d
	picture = GFX_news_event_polish_resistance_warsaw
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = rm_news.3.a
		trigger = {
			NOT = {
				TAG = FROM
				all_country = {
					has_war_with = FROM
				}
			}
		}
	}
	option = {
		name = rm_news.3.b
		trigger = { TAG = FROM }
	}
	option = {
		name = rm_news.3.c
		trigger = { 
			all_country = { 
				has_war_with = FROM
			}
		}
	}
}

news_event = {
	id = rm_news.4
	title = rm_news.4.t
	desc = rm_news.4.d
	picture = GFX_news_event_fallen_warszawa
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = rm_news.4.a
		trigger = {
			NOT = {
				TAG = FROM
				all_country = {
					has_war_with = FROM
				}
			}
		}
	}
	option = {
		name = rm_news.4.b
		trigger = { TAG = FROM }
	}
	option = {
		name = rm_news.4.c
		trigger = { 
			all_country = { 
				has_war_with = FROM
			}
		}
	}
}

news_event = {
	id = rm_news.5
	title = rm_news.5.t
	desc = rm_news.5.d
	picture = GFX_news_event_pilecki
	
	major = yes
	
	fire_only_once = yes
	
	trigger = {
		GER = { 
			has_war_with = POL 
			has_government = fascism
			controls_state = 937 # Oświencim
		}
		POL = {
			OR = {
				has_country_flag = airborne_special_forces
				AND = { date > 1943.1.1 }
			}
		}
	}
	
	mean_time_to_happen = {
		days = 365
	}
	
	option = {
		name = rm_news.5.a
		trigger = {
			NOT = {
				OR = {
					original_tag = GER
					is_in_faction_with = GER
				}
			}
		}
		
		if = {
			limit = { original_tag = POL }
			add_legitimacy = 10
		}
	}
	option = {
		name = rm_news.5.b
		trigger = { original_tag = GER }
		
		add_political_power = -20
	}
	option = {
		name = rm_news.5.c
		trigger = { is_in_faction_with = GER }
		
		add_political_power = -5
	}
}