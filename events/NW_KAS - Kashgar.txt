add_namespace = NW_KAS
add_namespace = NW_KAS_news

# Вторая республика Восточного Туркестана
news_event = {
	id = NW_KAS_news.0
	title = NW_KAS_news.0.t
	desc = NW_KAS_news.0.d
	picture = GFX_news_event_dutch_soldiers_indonesia
	major = yes
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS_news.0" }
	option = {
		name = NW_KAS_news.0.a
		trigger = { is_literally_china = no }
	}
	option = {
		name = NW_KAS_news.0.b
		trigger = { tag = FROM }
	}
	option = {
		name = NW_KAS_news.0.c
		trigger = { is_literally_china = yes NOT = { tag = FROM } }
	}
}

# Провозглашение Королевства Исламистан
news_event = {
	id = NW_KAS_news.1
	title = NW_KAS_news.1.t
	desc = NW_KAS_news.1.d
	picture = GFX_news_event_dutch_soldiers_indonesia
	major = yes
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS_news.1" }
	option = {
		name = NW_KAS_news.1.a
		trigger = { is_literally_china = no }
	}
	option = {
		name = NW_KAS_news.1.b
		trigger = { tag = FROM }
	}
	option = {
		name = NW_KAS_news.1.c
		trigger = { is_literally_china = yes NOT = { tag = FROM } }
	}
}

# Убийство главного кади Кашгара
country_event = {
	id = NW_KAS.0
	title = NW_KAS.0.t
	desc = NW_KAS.0.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.0" }
	option = {
		name = NW_KAS.0.a
		add_popularity = { ideology = neutrality popularity = 0.03 }
		#TODO: Абдулгафур Дамолла будет убит
	}
}

# Взрыв Синьцзяня
country_event = {
	id = NW_KAS.1
	title = NW_KAS.1.t
	desc = NW_KAS.1.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.1" }
	option = {
		name = NW_KAS.1.a
		trigger = { tag = KAS }
		if = {
			limit = { has_idea = KAS_uighur_nationalism_idea }
			remove_ideas = KAS_uighur_nationalism_idea
		}
		if = {
			limit = { has_idea = KAS_closure_of_muslim_schools_and_madrassas_idea }
			remove_ideas = KAS_closure_of_muslim_schools_and_madrassas_idea
		}
		if = {
			limit = { NOT = { has_template = "Uighur Nationalists" } }
			division_template = {
				name = "Uighur Nationalists"
				is_locked = no
				division_names_group = CHI_INF_01
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
				}
			}
		}
		capital_scope = {
			if = {
				limit = { ROOT = { neutrality > 0.6 } }
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 4
				}
			}
			else_if = {
				limit = { ROOT = { neutrality > 0.35 } }
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 3
				}
			}
			else = {
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 2
				}
			}
		}
		set_politics = { ruling_party = neutrality elections_allowed = no }
		add_country_leader_role = {
			character = KAS_mahmud_muhiti
			promote_leader = yes
			country_leader = {
				ideology = militarism_ideology
				expire = "1965.1.1.1"
				traits = {  }
			}
		}
		OVERLORD = {
			hidden_effect = { end_puppet = ROOT }
			ROOT = { declare_war_on = { target = PREV type = liberate_wargoal } }
		}
		effect_tooltip = { unlock_national_focus = KAS_last_uprising }
	}
	option = {
		name = NW_KAS.1.b
		trigger = { NOT = { tag = KAS } }
	}
}

# Абдул Нияз поднимает восстание
country_event = {
	id = NW_KAS.2
	title = NW_KAS.2.t
	desc = NW_KAS.2.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.2" }
	option = {
		name = NW_KAS.2.a
		set_country_flag = KAS_leader_of_the_uprising_was_abdul_niyaz_flag
		add_popularity = { ideology = neutrality popularity = 0.3 }
		if = {
			limit = { has_idea = KAS_uighur_nationalism_idea }
			remove_ideas = KAS_uighur_nationalism_idea
		}
		if = {
			limit = { has_idea = KAS_closure_of_muslim_schools_and_madrassas_idea }
			remove_ideas = KAS_closure_of_muslim_schools_and_madrassas_idea
		}
		if = {
			limit = { NOT = { has_template = "Uighur Nationalists" } }
			division_template = {
				name = "Uighur Nationalists"
				is_locked = no
				division_names_group = CHI_INF_01
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
				}
			}
		}
		capital_scope = {
			if = {
				limit = { ROOT = { neutrality > 0.6 } }
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 4
				}
			}
			else_if = {
				limit = { ROOT = { neutrality > 0.35 } }
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 3
				}
			}
			else = {
				create_unit = {
					division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
					owner = ROOT
					count = 2
				}
			}
		}
		if = {
			limit = { NOT = { has_government = neutrality } }
			set_politics = { ruling_party = neutrality elections_allowed = no }
		}
		promote_character = KAS_abdullah_niyaz
		OVERLORD = {
			hidden_effect = { end_puppet = ROOT }
			ROOT = { declare_war_on = { target = PREV type = liberate_wargoal } }
		}
		effect_tooltip = { unlock_national_focus = KAS_last_uprising }
		hidden_effect = {
			if = {
				limit = {
					RAJ = {
						exists = yes
						is_subject_of = ENG
						NOT = { has_war_with = ROOT }
					}
				}
				ENG = { country_event = { id = NW_KAS.9 days = 10 } }			#Махмуд Мухити пересек границу
			}
			else_if = {
				limit = {
					CHI = {
						exists = yes
						NOT = { has_war_with = ROOT }
					}
				}
				CHI = { country_event = { id = NW_KAS.8 days = 35 } }			#Письмо консулу в Индии
			}
		}
	}
}

# SIK, KUM, DZH Уйгурское восстание
country_event = {
	id = NW_KAS.3
	title = NW_KAS.3.t
	desc = NW_KAS.3.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.3" }
	option = {
		name = NW_KAS.3.a
	}
}

# CHI Письмо консулу в Индии
country_event = {
	id = NW_KAS.8
	title = NW_KAS.8.t
	desc = NW_KAS.8.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.8" }
	option = {
		name = NW_KAS.8.a
		ai_chance = {
			base = 1
			modifier = {
				add = -1
				is_historical_focus_on = yes
			}
		}
		KAS = { country_event = { id = NW_KAS.11 days = 30 } }				#Возвращение Мухити из Китая
	}
	option = {
		name = NW_KAS.8.b
		ai_chance = { base = 1 }
		ENG = { country_event = { id = NW_KAS.4 days = 30 } }				#Мухити обращается к нам за помощью
	}
}

# ENG Махмуд Мухити пересек границу
country_event = {
	id = NW_KAS.9
	title = NW_KAS.9.t
	desc = NW_KAS.9.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	trigger = {
		RAJ = {
			exists = yes
			is_subject_of = ROOT
			NOT = { has_war_with = FROM }
		}
	}
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.9" }
	option = {
		name = NW_KAS.9.a
		if = {
			limit = {
				CHI = {
					exists = yes
					NOT = { has_war_with = FROM }
				}
			}
			CHI = { country_event = { id = NW_KAS.8 days = 25 } }			#Письмо консулу в Индии
		}
	}
}

# ENG Мухити обращается к нам за помощью
country_event = {
	id = NW_KAS.4
	title = NW_KAS.4.t
	desc = NW_KAS.4.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.4" }
	option = {
		name = NW_KAS.4.a
		trigger = {
			has_subject = RAJ
			has_war = no
		}
		ai_chance = {
			base = 1
			modifier = {
				add = -1
				is_historical_focus_on = yes
			}
		}
		KAS = { country_event = { id = NW_KAS.7 days = 30 } }				#Возвращение Мухити с британцами
	}
	option = {
		name = NW_KAS.4.b
		ai_chance = { base = 1 }
		hidden_effect = {		
			if = {
				limit = {
					AFG = {
						exists = yes
						NOT = { has_war_with = KAS }
					}
				}
				AFG = { country_event = { id = NW_KAS.5 days = 30 }	}		#Прибытие уйгурского лидера
			}
			else = {
				KAS = { country_event = { id = NW_KAS.6 days = 30 } }		#Возвращение лидера
			}
		}
	}
}

# Пульсар
country_event = {
	hidden = yes
    id = NW_KAS.14
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): hidden event NW_KAS.14" }
	immediate = {
		if = {
			limit = { has_country_leader = { character = KAS_abdullah_niyaz ruling_only = yes } }
			country_event = NW_KAS.15																	#Возвращение Мухити
		}
		else_if = {
			limit = {
				JAP = {
					exists = yes
					has_war_with = CHI
					NOT = { has_war_with = ROOT }
				}
			}
			JAP = { country_event = NW_KAS.16 }														 	#Прибытие в Японию Махмуда Мухити
		}
		else_if = {
			limit = {
				AFG = {
					exists = yes
					has_completed_focus = AFG_central_Asian_Islamic_Federation
					has_country_leader = { character = AFG_Amanulla ruling_only = yes }
					NOT = { has_war_with = ROOT }
				}
			}
			AFG = { country_event = NW_KAS.17 }														 	#Прибытие в Кабул уйгурских лидеров
		}
		else_if = {
			limit = {
				CHI = {
					exists = yes
					NOT = { has_war_with = ROOT }
				}
			}
			CHI = { country_event = NW_KAS.18 }														 	#Судьба уйгурских повстанцев
		}
		else = {
			random_other_country = {
				limit = {
					is_literally_china = yes
					NOT = { has_war_with = ROOT }
					controls_state = 613		#Нанкин
				}
				country_event = NW_KAS.18																#Прибытие уйгурских повстанцев
			}
		}
	}
}

# AFG Прибытие уйгурского лидера
country_event = {
	id = NW_KAS.5
	title = NW_KAS.5.t
	desc = NW_KAS.5.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.5" }
	option = {
		name = NW_KAS.5.a
		KAS = { country_event = { id = NW_KAS.12 days = 20 } }								#Мухити вернулся из Кабула
	}
	option = {
		name = NW_KAS.5.b
		hidden_effect = {
			279 = { controller = { country_event = { id = NW_KAS.13 days = 30 } } }			#Прибытие лидера уйгурских повстанцев
			KAS = { country_event = { id = NW_KAS.14 days = 270 } }							#Пульсар
		}
	}
}

# TNG, DZH, KUM Последний шанс
country_event = {
	id = NW_KAS.6
	title = NW_KAS.6.t
	desc = NW_KAS.6.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.6" }
	option = {
		name = NW_KAS.6.a
		if = {
			limit = { is_subject = yes }
			OVERLORD = {
				hidden_effect = { end_puppet = ROOT }
				ROOT = { declare_war_on = { target = PREV type = liberate_wargoal } }
			}
		}
		if = {
			limit = { has_war_with = FROM }
			white_peace = { tag = FROM }
		}
	}
	option = {
		name = NW_KAS.6.b
		trigger = { has_government = communism }
	}
}

# Возвращение Мухити с британцами
country_event = {
	id = NW_KAS.7
	title = NW_KAS.7.t
	desc = NW_KAS.7.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.7" }
	option = {
		name = NW_KAS.7.a
		add_equipment_to_stockpile = { type = infantry_equipment amount = 2000 producer = FROM }
		add_equipment_to_stockpile = { type = artillery_equipment amount = 100 producer = FROM }
		add_timed_idea = { idea = KAS_excitement_of_muhiti_return_idea days = 180 }
		promote_character = KAS_mahmud_muhiti
	}
}

# Возвращение Мухити из Китая
country_event = {
	id = NW_KAS.11
	title = NW_KAS.11.t
	desc = NW_KAS.11.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.11" }
	option = {
		name = NW_KAS.11.a
		add_equipment_to_stockpile = { type = infantry_equipment amount = 3000 producer = FROM }
		add_timed_idea = { idea = KAS_excitement_of_muhiti_return_idea days = 180 }
		promote_character = KAS_mahmud_muhiti
	}
}

# Мухити вернулся из Кабула
country_event = {
	id = NW_KAS.12
	title = NW_KAS.12.t
	desc = NW_KAS.12.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.12" }
	option = {
		name = NW_KAS.12.a
		if = {
			limit = { NOT = { has_template = "Uighur Nationalists" } }
			division_template = {
				name = "Uighur Nationalists"
				is_locked = no
				division_names_group = CHI_INF_01
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
				}
			}
		}
		capital_scope = {
			create_unit = {
				division = "division_template = \"Uighur Nationalists\" start_experience_factor = 0.2"
				owner = ROOT
				count = 2
			}
		}
		add_timed_idea = { idea = KAS_excitement_of_muhiti_return_idea days = 180 }
		promote_character = KAS_mahmud_muhiti
	}
}

# 279.controller Прибытие лидера уйгурских повстанцев
country_event = {
	id = NW_KAS.13
	title = NW_KAS.13.t
	desc = NW_KAS.13.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.13" }
	option = {
		name = NW_KAS.13.a
	}
}

# Возвращение Мухити
country_event = {
	id = NW_KAS.15
	title = NW_KAS.15.t
	desc = NW_KAS.15.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.15" }
	option = {
		name = NW_KAS.15.a
		add_timed_idea = { idea = KAS_excitement_of_muhiti_return_idea days = 180 }
		promote_character = KAS_mahmud_muhiti
	}
}

# JAP Прибытие в Японию Махмуда Мухити
country_event = {
	id = NW_KAS.16
	title = NW_KAS.16.t
	desc = NW_KAS.16.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.16" }
	option = {
		name = NW_KAS.16.a
	}
}

# AFG Прибытие в Кабул уйгурских лидеров
country_event = {
	id = NW_KAS.17
	title = NW_KAS.17.t
	desc = NW_KAS.17.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.17" }
	option = {
		name = NW_KAS.17.a
		#TODO: станет доступна категория решений «Восстание в Восточном Туркестане»
	}
}

# CHI Судьба уйгурских повстанцев
country_event = {
	id = NW_KAS.18
	title = {
		text = NW_KAS.18.t.a
		trigger = { original_tag = CHI }
	}
	title = {
		text = NW_KAS.18.t.b
		trigger = { NOT = { original_tag = CHI } }
	}
	desc = NW_KAS.18.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.18" }
	option = {
		name = NW_KAS.18.a
		add_political_power = -50
		add_stability = 0.01
	}
	option = {
		name = NW_KAS.18.b
	}
}

# Монгольское население
country_event = {
	id = NW_KAS.10
	title = NW_KAS.10.t
	desc = NW_KAS.10.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.10" }
	option = {
		name = NW_KAS.10.a
	}
	option = {
		name = NW_KAS.10.b
	}
	option = {
		name = NW_KAS.10.c
	}
}

# Прибытие короля в Кашгар
country_event = {
	id = NW_KAS.19
	title = NW_KAS.19.t
	desc = NW_KAS.19.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.19" }
	option = {
		name = NW_KAS.19.a
		add_ideas = KAS_khalid_i_idea
	}
}

# Ликвидация королевства
country_event = {
	id = NW_KAS.20
	title = NW_KAS.20.t
	desc = NW_KAS.20.d
	picture = GFX_report_event_hol_cabinet_de_geer
	is_triggered_only = yes
	immediate = { log = "[GetDateText]: [Root.GetName] ([Root.GetTag]): event NW_KAS.20" }
	option = {
		name = NW_KAS.20.a
		if = {
			limit = { has_idea = KAS_khalid_i_idea }
			remove_ideas = KAS_khalid_i_idea
		}
		add_timed_idea = { idea = KAS_consequences_of_the_liquidation_of_the_monarchy_idea days = 1500 }
		set_country_flag = KAS_finish_the_craziest_plan_category_BLOCK_flag
		custom_effect_tooltip = KAS_finish_the_craziest_plan_category_block_tt
	}
}