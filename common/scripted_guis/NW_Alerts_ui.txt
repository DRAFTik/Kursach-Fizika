scripted_gui = {

    nw_Legitimacy_alert = {
		context_type = player_context
		parent_window_token = top_bar
		window_name = "legitimacy_alert"
		
		ai_enabled = { always = no }
		visible = { has_country_flag = change_legitimacy_flag }

		triggers = {
			background_green_visible = {
				check_variable = { GUI_up_or_down_status_var = 2 }
			}
			background_red_visible = {
				check_variable = { GUI_up_or_down_status_var = 1 }
			}
		}
		effects = {
			close_button_click = { clr_country_flag = change_legitimacy_flag }
			
			legitimacy_alert_effect_click = {
				set_temp_variable = { temp_num_current_legitimacy_idea_var = GUI_num_current_legitimacy_idea_var }
				set_temp_variable = { temp_num_new_legitimacy_idea_var = GUI_num_new_legitimacy_idea_var }
				
				meta_effect = {
					text = {
						swap_ideas = {
							remove_idea = [NUM_CURRENT_LEG_IDEA]_legitimacy
							add_idea = [NUM_NEW_LEG_IDEA]_legitimacy
						}
					}
					NUM_CURRENT_LEG_IDEA = "[?temp_num_current_legitimacy_idea_var.GetTokenKey]"
					NUM_NEW_LEG_IDEA = "[?temp_num_new_legitimacy_idea_var.GetTokenKey]"
				}
			}
		}
	}
}