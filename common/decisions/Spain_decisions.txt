spain_civil_war_north_category = {

	SPR_north_asu = {

		icon = generic_operation

		allowed = {
			tag = SPR
		}

		available = {
			ASU = { exists = no }
			owns_state = 983
		}

		highlight_states = { state = 983 }

		#on_map_mode = map_only

		cost = 10

		fire_only_once = yes

		visible = {
			tag = SPR
			ASU = { exists = no }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			release_puppet = ASU
			hidden_effect = {
				174 = { add_core_of = ASU }
				if = {
					limit = { SPR = { controls_state = 174 } }
					ASU = { transfer_state = 174 }
				}
				ASU = {
					set_politics = {
						parties = {
							democratic = { 
								popularity = 40
							}
							fascism = {
								popularity = 40
							}
							communism = {
								popularity = 10
							}
						}
						ruling_party = democratic
						last_election = "1935.1.1"
						election_frequency = 36
						elections_allowed = yes
					}
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = 1000
					}
					ASU = { country_event = { id = NWspain.904 } }
					set_cosmetic_tag = ASU_interprov
				}
			}
		}

		ai_will_do = {
			factor = 10
			modifier = {
				factor = 0
				num_of_controlled_states > 12
			}
		}
	}
	
	SPR_north_snt = {

		icon = generic_operation

		allowed = {
			tag = SPR
		}

		available = {
			SNT = { exists = no }
			owns_state = 982
		}

		highlight_states = { state = 982 }

		#on_map_mode = map_only

		cost = 10

		fire_only_once = yes

		visible = {
			tag = SPR
			SNT = { exists = no }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			release_puppet = SNT
			hidden_effect = {
				SNT = {
					set_politics = {
						parties = {
							democratic = { 
								popularity = 40
							}
							fascism = {
								popularity = 40
							}
							communism = {
								popularity = 10
							}
						}
						ruling_party = democratic
						last_election = "1935.1.1"
						election_frequency = 36
						elections_allowed = yes
					}
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = 1000
					}
					SNT = { country_event = { id = NWspain.905 } }
					set_cosmetic_tag = SNT_interprov
				}
			}
		}

		ai_will_do = {
			factor = 10
			modifier = {
				factor = 0
				num_of_controlled_states > 12
			}
		}
	}
}

spain_civil_war_category = {

	#Предложить националистам мир // ARA
	ARA_SPA_make_peace = {

		icon = decision_hol_exchange_intelligence_data
		
		allowed = {
			original_tag = ARA
		}

		available = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
			is_subject = no
			OR = {
				has_government = democratic
				has_government = fascism
				has_government = neutrality
				has_government = monarchy
			}
		}

		visible = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
		}
		
		days_re_enable = 30
		
		cost = 10
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions ARA_SPA_make_peace"
			SPA = { country_event = { id = NWspain.206 } }
		}
		
		ai_will_do = {
			factor = 200
		}
	}
	
	#Предложить националистам мир // CAT
	CAT_SPA_make_peace = {

		icon = decision_hol_exchange_intelligence_data
		
		allowed = {
			original_tag = CAT
		}

		available = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
			is_subject = no
			OR = {
				has_government = democratic
				has_government = fascism
				has_government = neutrality
				has_government = monarchy
			}
		}

		visible = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
		}
		
		days_re_enable = 30
		
		cost = 10
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions CAT_SPA_make_peace"
			SPA = { country_event = { id = NWspain.307 } }
		}
		
		ai_will_do = {
			factor = 200
		}
	}
	
	#Активизировать Пятую колонну // SPA
	SPA_activate_fifth_column = {

		icon = decision_eng_propaganda_campaigns
		
		allowed = {
			original_tag = SPA
		}

		available = {
			has_war_with = SPR
			NOT = { has_global_flag = scw_over }
			SPR = { surrender_progress > 0.7 }
		}

		visible = {
			has_war_with = SPR
			NOT = { has_global_flag = scw_over }
		}
		
		fire_only_once = yes
		cost = 25
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPA_activate_fifth_column"
			SPR = { add_war_support = -0.04 }
		}
		
		ai_will_do = {
			factor = 200
		}
	}
		
	#Организация народной милиции // SPR
	SPR_organization_peoples_militia = {

		icon = decision_generic_prepare_civil_war
		
		allowed = {
			original_tag = SPR
		}

		available = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
		}

		visible = {
			has_war_with = SPA
			NOT = { has_global_flag = scw_over }
		}
		
		fire_only_once = yes
		cost = 150
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPR_organization_peoples_militia"
			add_war_support = 0.1
			hidden_effect = {
				division_template = {
					name = "People Militia"
					is_locked = yes
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
					}
				}
			}
			capital_scope = {
				create_unit = {
					division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = {
					division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = {
					division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = {
					division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = {
					division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
					owner = ROOT
				}
			}
			
			if = {
				limit = { num_subjects > 0 }
				every_other_country = {
					limit = {
						OR = {
							is_puppet_of = ROOT
							is_subject_of = ROOT
						}
					}
					hidden_effect = {
						division_template = {
							name = "People Militia"
							is_locked = yes
							regiments = {
								infantry = { x = 0 y = 0 }
								infantry = { x = 0 y = 1 }
							}
						}
					}
					add_war_support = 0.1
					capital_scope = {
						create_unit = {
							division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
							owner = PREV
						}
						create_unit = {
							division = "name = \"People Militia\" division_template = \"People Militia\" start_experience_factor = 0.1" 
							owner = PREV
						}
					}
				}
			}
		}
		
		ai_will_do = {
			factor = 2
		}
	}
}

spain_decision_category = {

	#Возродить Испанскую империю // SPA
	SPA_revive_spanish_empire = {

		icon = decision_generic_form_nation
		
		allowed = {
			original_tag = SPA
		}

		available = {
			all_state = {
				OR = {
					NOT = {
						is_core_of = VEN
						is_core_of = COL
					}
					is_controlled_by = ROOT
				}
			}
		}

		visible = {
		}
		
		fire_only_once = yes
		cost = 200
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPA_revive_spanish_empire"
			set_cosmetic_tag = SPA_empire
			every_state = {
				limit = {
					OR = {
						is_core_of = VEN
						is_core_of = COL
					}
				}
				add_core_of = ROOT
			}
		}
		
		ai_will_do = {
			factor = 100
		}
	}
	
	#Создание Священной Римской империи // SPA
	SPA_creation_holy_roman_empire = {

		icon = decision_generic_form_nation
		
		allowed = {
			original_tag = SPA
		}

		available = {
			all_state = {
				OR = {
					NOT = {
						is_core_of = AUS
					}
					is_controlled_by = ROOT
				}
			}
			OR = {
				has_country_leader = {
					name = "Xavier of Bourbon-Parma"
					ruling_only = yes
				}
				has_country_leader = {
					name = "Otto von Habsburg"
					ruling_only = yes
				}
			}
		}

		visible = {
		}
		
		fire_only_once = yes
		cost = 100
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPA_creation_holy_roman_empire"
			set_cosmetic_tag = SPA_hre
			every_state = {
				limit = {
					is_core_of = AUS
				}
				add_core_of = ROOT
			}
		}
		
		ai_will_do = {
			factor = 200
		}
	}
	
	#Оккупировать Танжер // Оба
	SPR_occupy_tangier = {

		icon = decision_oppression
		
		allowed = {
			OR = {
				original_tag = SPA
				original_tag = SPR
			}
		}

		available = {
			1042 = { is_fully_controlled_by = TNG }
			OR = {
				OR = {
					FRC = { is_subject = yes }
					NOT = { country_exists = FRC }
				}
				OR = {
					FRA = { is_subject = yes }
					NOT = { country_exists = FRA }
				}
			}
			threat > 0.4
		}

		visible = {
			country_exists = TNG
			OR = {
				original_tag = SPA
				original_tag = SPR
			}
			OR = {
				has_government = neutrality
				has_government = fascism
				has_government = monarchy
			}
		}
		
		fire_only_once = yes
		cost = 0
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPR_occupy_tangier"
			annex_country = {
				target = TNG
				transfer_troops = yes
			}
		}
		
		ai_will_do = {
			factor = 200
		}
	}

}

spain_liberal_loyality_category = {

	SPR_infotable_liberal_loyality = {

		icon = decision_generic_decision
		
		allowed = {
			original_tag = SPR
		}

		available = {
			always = no
		}

		visible = {
			#always = yes
			has_completed_focus = SPR_victory_liberal_party
			has_country_flag = libarals_loyality_flag
		}
		
		fire_only_once = yes
		cost = 0
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions SPR_infotable_liberal_loyality"
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}

catalon_decision_category = {

	CAT_integrate_catalon_lands = {

		icon = decision_generic_civil_support
		
		allowed = {
			original_tag = CAT
		}

		available = {
			has_full_control_of_state = 1043
			has_full_control_of_state = 167
			has_full_control_of_state = 177
		}

		visible = {
		}
		
		fire_only_once = yes
		cost = 100
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decisions CAT_integrate_catalon_lands"
			set_cosmetic_tag = CAT_great
			every_state = {
				limit = {
					state = 1043
					state = 167
					state = 177					
				}
				add_core_of = ROOT
			}
		}
		
		ai_will_do = {
			factor = 200
		}
	}
}


