# перед командой нужно указывать set_temp_variable = { disband_unit_fraction_temp = ХХ }

# ПРИМЕР (удаляет 50% дивизий):
# set_temp_variable = { disband_unit_fraction_temp = 50 }
# disband_units_fraction = yes

disband_units_fraction = {
	set_temp_variable = { disband_unit_fraction = disband_unit_fraction_temp }
	multiply_temp_variable = { disband_unit_fraction = 0.01 }
	SAI = {
		set_temp_variable = {
			old_manpower = manpower_k
		}
	}
	random_state = {
		limit = {
			is_coastal = no
			owner = {
				PREV = {
					is_fully_controlled_by = PREV
				}
			}
		}
		owner = { save_event_target_as = disband_state_owner }
		save_event_target_as = disband_state
		SAI = { set_state_owner = PREV }
	}
	transfer_units_fraction = {
		target = SAI
		size = 0
		army_ratio = var:disband_unit_fraction
		keep_unit_leaders_trigger = {
			always = yes
		}
	}
	SAI = {
		every_state = {
			SAI = {
				delete_unit = {
					state = PREV
					disband = yes
				}
			}
		}
		set_temp_variable = {
			manpower_diff = manpower_k
		}
		subtract_from_temp_variable = {
			manpower_diff = old_manpower
		}
		while_loop_effect = { #avoid overflows
			limit = { check_variable = { manpower_diff > 1 } }
			subtract_from_temp_variable = { manpower_diff = 1 }
			ROOT = { add_manpower = 1000 }
			add_manpower = -1000
		}
		multiply_temp_variable = {
			manpower_diff = 1000
		}
		ROOT = { add_manpower = PREV.manpower_diff }
		multiply_temp_variable = {
			manpower_diff = -1
		}
		add_manpower = manpower_diff
		transfer_units_fraction = {
			target = ROOT
			size = 0
			stockpile_ratio = 1
			keep_unit_leaders_trigger = {
				always = yes
			}
		}
	}
	event_target:disband_state = {
		event_target:disband_state_owner = { set_state_owner = PREV }
	}
	annex_country = {
		target = SAI
	}
}

POR_influence_of_church_in_central_importance = {
	if = {
		limit = { has_idea = POR_influence_of_church_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_1
			add_idea = POR_influence_of_church_central_1
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_2
			add_idea = POR_influence_of_church_central_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_3
			add_idea = POR_influence_of_church_central_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_4
			add_idea = POR_influence_of_church_central_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_5 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_5
			add_idea = POR_influence_of_church_central_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_6 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_6
			add_idea = POR_influence_of_church_central_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_7 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_7
			add_idea = POR_influence_of_church_central_7
		}
	}
}

POR_influence_of_church_partner_of_crown = {
	if = {
		limit = { has_idea = POR_influence_of_church_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_1
			add_idea = POR_influence_of_church_partner_1
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_2
			add_idea = POR_influence_of_church_partner_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_3
			add_idea = POR_influence_of_church_partner_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_4
			add_idea = POR_influence_of_church_partner_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_5 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_5
			add_idea = POR_influence_of_church_partner_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_6 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_6
			add_idea = POR_influence_of_church_partner_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_7 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_7
			add_idea = POR_influence_of_church_partner_7
		}
	}
}

POR_influence_of_church_up = {
	if = {
		limit = { has_idea = POR_influence_of_church_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_1
			add_idea = POR_influence_of_church_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_2
			add_idea = POR_influence_of_church_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_3
			add_idea = POR_influence_of_church_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_4
			add_idea = POR_influence_of_church_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_5 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_5
			add_idea = POR_influence_of_church_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_6 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_6
			add_idea = POR_influence_of_church_7
		}
	}
	
	
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_1
			add_idea = POR_influence_of_church_central_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_2
			add_idea = POR_influence_of_church_central_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_3
			add_idea = POR_influence_of_church_central_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_4
			add_idea = POR_influence_of_church_central_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_5 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_5
			add_idea = POR_influence_of_church_central_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_6 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_6
			add_idea = POR_influence_of_church_central_7
		}
	}
	
	
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_1
			add_idea = POR_influence_of_church_partner_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_2
			add_idea = POR_influence_of_church_partner_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_3
			add_idea = POR_influence_of_church_partner_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_4
			add_idea = POR_influence_of_church_partner_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_5 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_5
			add_idea = POR_influence_of_church_partner_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_6 NOT = { has_completed_focus = POR_sign_concordat_with_vatican } }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_6
			add_idea = POR_influence_of_church_partner_7
		}
	}
}

POR_influence_of_church_down = {
	if = {
		limit = { has_idea = POR_influence_of_church_7 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_7
			add_idea = POR_influence_of_church_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_6 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_5
			add_idea = POR_influence_of_church_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_5 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_5
			add_idea = POR_influence_of_church_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_4
			add_idea = POR_influence_of_church_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_3
			add_idea = POR_influence_of_church_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_2
			add_idea = POR_influence_of_church_1
		}
	}
	
	
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_7 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_7
			add_idea = POR_influence_of_church_central_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_6 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_5
			add_idea = POR_influence_of_church_central_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_5 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_5
			add_idea = POR_influence_of_church_central_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_4
			add_idea = POR_influence_of_church_central_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_3
			add_idea = POR_influence_of_church_central_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_central_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_central_2
			add_idea = POR_influence_of_church_central_1
		}
	}
	
	
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_7 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_7
			add_idea = POR_influence_of_church_partner_6
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_6 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_5
			add_idea = POR_influence_of_church_partner_5
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_5 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_5
			add_idea = POR_influence_of_church_partner_4
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_4 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_4
			add_idea = POR_influence_of_church_partner_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_3
			add_idea = POR_influence_of_church_partner_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_church_partner_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_church_partner_2
			add_idea = POR_influence_of_church_partner_1
		}
	}
}



### НАЦДУХИ КОЛОНИЙ ###

POR_ANG_debts_of_local_residents_idea_down = {
	if = {
		limit = { has_idea = POR_ANG_debts_of_local_residents_idea_1 }
		swap_ideas = {
			remove_idea = POR_ANG_debts_of_local_residents_idea_1
			add_idea = POR_ANG_debts_of_local_residents_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_debts_of_local_residents_idea_2 }
		swap_ideas = {
			remove_idea = POR_ANG_debts_of_local_residents_idea_2
			add_idea = POR_ANG_debts_of_local_residents_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_debts_of_local_residents_idea_3 }
		remove_ideas = POR_ANG_debts_of_local_residents_idea_3
	}
}

POR_ANG_export_of_angolan_goods_idea_up = {
	if = {
		limit = { has_idea = POR_ANG_export_of_angolan_goods_idea_1 }
		swap_ideas = {
			remove_idea = POR_ANG_export_of_angolan_goods_idea_1
			add_idea = POR_ANG_export_of_angolan_goods_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_export_of_angolan_goods_idea_2 }
		swap_ideas = {
			remove_idea = POR_ANG_export_of_angolan_goods_idea_2
			add_idea = POR_ANG_export_of_angolan_goods_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_export_of_angolan_goods_idea_3 }
		swap_ideas = {
			remove_idea = POR_ANG_export_of_angolan_goods_idea_3
			add_idea = POR_ANG_export_of_angolan_goods_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_export_of_angolan_goods_idea_4 }
		swap_ideas = {
			remove_idea = POR_ANG_export_of_angolan_goods_idea_4
			add_idea = POR_ANG_export_of_angolan_goods_idea_5
		}
	}
	else = { add_ideas = POR_ANG_export_of_angolan_goods_idea_1 }
}

POR_MZB_export_of_goods_from_mozambique_idea_up = {
	if = {
		limit = { has_idea = POR_MZB_export_of_goods_from_mozambique_idea_1 }
		swap_ideas = {
			remove_idea = POR_MZB_export_of_goods_from_mozambique_idea_1
			add_idea = POR_MZB_export_of_goods_from_mozambique_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_export_of_goods_from_mozambique_idea_2 }
		swap_ideas = {
			remove_idea = POR_MZB_export_of_goods_from_mozambique_idea_2
			add_idea = POR_MZB_export_of_goods_from_mozambique_idea_3
		}
	}
	else = { add_ideas = POR_MZB_export_of_goods_from_mozambique_idea_1 }
}



POR_ANG_number_of_assimilators_idea_up = {
	if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_1 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_1
			add_idea = POR_ANG_number_of_assimilators_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_2 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_2
			add_idea = POR_ANG_number_of_assimilators_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_3 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_3
			add_idea = POR_ANG_number_of_assimilators_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_4 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_4
			add_idea = POR_ANG_number_of_assimilators_idea_5
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_5 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_5
			add_idea = POR_ANG_number_of_assimilators_idea_6
		}
	}
}
POR_ANG_number_of_assimilators_idea_double_up = {
	if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_1 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_1
			add_idea = POR_ANG_number_of_assimilators_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_2 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_2
			add_idea = POR_ANG_number_of_assimilators_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_3 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_3
			add_idea = POR_ANG_number_of_assimilators_idea_5
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_4 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_4
			add_idea = POR_ANG_number_of_assimilators_idea_6
		}
	}
	else_if = {
		limit = { has_idea = POR_ANG_number_of_assimilators_idea_5 }
		swap_ideas = {
			remove_idea = POR_ANG_number_of_assimilators_idea_5
			add_idea = POR_ANG_number_of_assimilators_idea_6
		}
	}
}

POR_MZB_number_of_assimilators_idea_up = {
	if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_1 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_1
			add_idea = POR_MZB_number_of_assimilators_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_2 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_2
			add_idea = POR_MZB_number_of_assimilators_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_3 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_3
			add_idea = POR_MZB_number_of_assimilators_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_4 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_4
			add_idea = POR_MZB_number_of_assimilators_idea_5
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_5 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_5
			add_idea = POR_MZB_number_of_assimilators_idea_6
		}
	}
}

POR_MZB_number_of_assimilators_idea_double_up = {
	if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_1 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_1
			add_idea = POR_MZB_number_of_assimilators_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_2 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_2
			add_idea = POR_MZB_number_of_assimilators_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_3 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_3
			add_idea = POR_MZB_number_of_assimilators_idea_5
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_4 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_4
			add_idea = POR_MZB_number_of_assimilators_idea_6
		}
	}
	else_if = {
		limit = { has_idea = POR_MZB_number_of_assimilators_idea_5 }
		swap_ideas = {
			remove_idea = POR_MZB_number_of_assimilators_idea_5
			add_idea = POR_MZB_number_of_assimilators_idea_6
		}
	}
}

POR_influence_of_communist_party_idea_up = {
	if = {
		limit = { has_idea = POR_influence_of_communist_party_idea_1 }
		swap_ideas = {
			remove_idea = POR_influence_of_communist_party_idea_1
			add_idea = POR_influence_of_communist_party_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_communist_party_idea_2 }
		swap_ideas = {
			remove_idea = POR_influence_of_communist_party_idea_2
			add_idea = POR_influence_of_communist_party_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_influence_of_communist_party_idea_3 }
		swap_ideas = {
			remove_idea = POR_influence_of_communist_party_idea_3
			add_idea = POR_influence_of_communist_party_idea_4
		}
	}
	else = {
		add_ideas = POR_influence_of_communist_party_idea_1
	}
}

POR_opposition_to_communist_party_idea_up = {
	if = {
		limit = { has_idea = POR_opposition_to_communist_party_idea_1 }
		swap_ideas = {
			remove_idea = POR_opposition_to_communist_party_idea_1
			add_idea = POR_opposition_to_communist_party_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_opposition_to_communist_party_idea_2 }
		swap_ideas = {
			remove_idea = POR_opposition_to_communist_party_idea_2
			add_idea = POR_opposition_to_communist_party_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_opposition_to_communist_party_idea_3 }
		swap_ideas = {
			remove_idea = POR_opposition_to_communist_party_idea_3
			add_idea = POR_opposition_to_communist_party_idea_4
		}
	}
	else = {
		add_ideas = POR_opposition_to_communist_party_idea_1
	}
}


set_cosmetic_POR_REDCOL_subject = {
	if = {
		limit = { is_african_country_for_POR_liberate_africa = yes }
		random_country_with_original_tag = {
			original_tag_to_check = PREV
			limit = {
				original_tag = PREV
				is_dynamic_tag = no
			}
			save_event_target_as = true_tag
			PREV = {
				meta_effect = {
					text = {
						set_cosmetic_tag = [TAG]_POR_REDCOL_subject
					}
					TAG = "[true_tag.GetTag]"
				}
			}
		}
	}
}

set_POR_REDCOL_start_effect = {
	add_ideas = {
		POR_REDCOL_oppressed_tribes_idea
		POR_REDCOL_lack_of_an_industrial_base_idea
	}
}




POR_pick_propaganda_slot_effect = {
	hidden_effect = {
		if = {
			limit = {
				check_variable = { POR_poster_left_icon_frame = POR_propaganda_empty_slot_index }
			}
			set_variable = { POR_poster_left_icon_frame = POR_new_propaganda_campaign }
			hidden_effect = {
				set_country_flag = { flag = POR_propaganda_left_days_remaining_flag days = 90 } #Need code support to use a var here
			}
		}
		else_if = {
			limit = {
				check_variable = { POR_poster_right_icon_frame = POR_propaganda_empty_slot_index }
			}
			set_variable = { POR_poster_right_icon_frame = POR_new_propaganda_campaign }
			hidden_effect = {
				set_country_flag = { flag = POR_propaganda_right_days_remaining_flag days = 90 } #Need code support to use a var here
			}
		}
		set_variable = { POR_new_propaganda_campaign = 0 } # Reset var
		add_to_variable = { SOV_propaganda_campaigns_taken = 1 } #Update propaganda campaigns counter
	}
}

POR_reset_propaganda_slot_effect = {
	hidden_effect = {
		if = {
			limit = {
				check_variable = { POR_poster_left_icon_frame = POR_propaganda_campaign_to_remove }
			}
			set_variable = { POR_poster_left_icon_frame = POR_propaganda_empty_slot_index }
		}
		else_if = { #This could be turned into an else, but leaving it like this to hopefully make it easier to see
			limit = {
				check_variable = { POR_poster_right_icon_frame = POR_propaganda_campaign_to_remove }
			}
			set_variable = { POR_poster_right_icon_frame = POR_propaganda_empty_slot_index }
		}
		set_variable = { POR_propaganda_campaign_to_remove = 0 } # Reset var
	}
}

POR_unlock_propaganda_campaign_slot_effect = {
	hidden_effect = {
		if = {
			limit = {
				check_variable = { POR_poster_left_icon_frame = POR_propaganda_locked_slot_index }
			}
			set_variable = { POR_poster_left_icon_frame = POR_propaganda_empty_slot_index }
		}
		else = {
			set_variable = { POR_poster_right_icon_frame = POR_propaganda_empty_slot_index }
		}
	}
}

POR_radical_republicanism_icon_frame_set_effect = {
	hidden_effect = {
		if = {
			limit = { check_variable = { POR_radical_republicanism_var < 1 } }
			set_variable = { POR_radical_republicanism_icon_frame = 1 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 11 } }
			set_variable = { POR_radical_republicanism_icon_frame = 2 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 21 } }
			set_variable = { POR_radical_republicanism_icon_frame = 3 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 31 } }
			set_variable = { POR_radical_republicanism_icon_frame = 4 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 42 } }
			set_variable = { POR_radical_republicanism_icon_frame = 5 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 55 } }
			set_variable = { POR_radical_republicanism_icon_frame = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 65 } }
			set_variable = { POR_radical_republicanism_icon_frame = 7 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 75 } }
			set_variable = { POR_radical_republicanism_icon_frame = 8 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 85 } }
			set_variable = { POR_radical_republicanism_icon_frame = 9 }
		}
		else_if = {
			limit = { check_variable = { POR_radical_republicanism_var < 99 } }
			set_variable = { POR_radical_republicanism_icon_frame = 10 }
		}
		else = {
			set_variable = { POR_radical_republicanism_icon_frame = 11 }
		}
	}
}

POR_legitimacy_of_crown_icon_frame_set_effect = {
	hidden_effect = {
		if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 1 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 1 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 11 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 2 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 21 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 3 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 31 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 4 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 42 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 5 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 55 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 65 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 7 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 75 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 8 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 85 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 9 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 99 } }
			set_variable = { POR_legitimacy_of_crown_icon_frame = 10 }
		}
		else = {
			set_variable = { POR_legitimacy_of_crown_icon_frame = 11 }
		}
	}
}

POR_social_problems_idea_down = {
	if = {
		limit = { has_idea = POR_social_problems_idea_10 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_10
			add_idea = POR_social_problems_idea_9
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_9 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_9
			add_idea = POR_social_problems_idea_8
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_8 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_8
			add_idea = POR_social_problems_idea_7
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_7 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_7
			add_idea = POR_social_problems_idea_6
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_6 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_6
			add_idea = POR_social_problems_idea_5
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_5 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_5
			add_idea = POR_social_problems_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_4 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_4
			add_idea = POR_social_problems_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_3 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_3
			add_idea = POR_social_problems_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_2 }
		swap_ideas = {
			remove_idea = POR_social_problems_idea_2
			add_idea = POR_social_problems_idea_1
		}
	}
	else_if = {
		limit = { has_idea = POR_social_problems_idea_1 }
		remove_ideas = POR_social_problems_idea_1
	}
}

POR_need_to_reform_kingdom_idea_down = {
	if = {
		limit = { has_idea = POR_need_to_reform_kingdom_idea_4 }
		swap_ideas = {
			remove_idea = POR_need_to_reform_kingdom_idea_4
			add_idea = POR_need_to_reform_kingdom_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_need_to_reform_kingdom_idea_3 }
		swap_ideas = {
			remove_idea = POR_need_to_reform_kingdom_idea_3
			add_idea = POR_need_to_reform_kingdom_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_need_to_reform_kingdom_idea_2 }
		swap_ideas = {
			remove_idea = POR_need_to_reform_kingdom_idea_2
			add_idea = POR_need_to_reform_kingdom_idea_1
		}
	}
	else_if = {
		limit = { has_idea = POR_need_to_reform_kingdom_idea_1 }
		remove_ideas = POR_need_to_reform_kingdom_idea_1
	}
}

POR_legitimacy_of_crown_check_effect = {
	hidden_effect = {
		POR_legitimacy_of_crown_icon_frame_set_effect = yes
		if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 0.01 } NOT = { has_country_flag = POR_legitimacy_of_crown_var_0 } }
			set_country_flag = POR_legitimacy_of_crown_var_0
			if = {
				limit = { has_country_flag = POR_regulate_order_of_succession_to_throne_flag }
				country_event = { id = NWportugal.86 hours = 6 }
			
				else = {
					country_event = { id = NWportugal.84 hours = 6 }
				}
			}
		}
		if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var < 0.01 } has_country_flag = POR_legitimacy_of_crown_var_0 }
			country_event = { id = NWportugal.86 hours = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var > 39.99 } NOT = { has_country_flag = POR_legitimacy_of_crown_var_40 } }
			set_country_flag = POR_legitimacy_of_crown_var_40
			country_event = { id = NWportugal.80 hours = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var > 59.99 } NOT = { has_country_flag = POR_legitimacy_of_crown_var_60 } }
			set_country_flag = POR_legitimacy_of_crown_var_60
			country_event = { id = NWportugal.81 hours = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var > 79.99 } NOT = { has_country_flag = POR_legitimacy_of_crown_var_80 } }
			set_country_flag = POR_legitimacy_of_crown_var_80
			country_event = { id = NWportugal.82 hours = 6 }
		}
		else_if = {
			limit = { check_variable = { POR_legitimacy_of_crown_var > 99.99 } NOT = { has_country_flag = POR_legitimacy_of_crown_var_100 } }
			set_country_flag = POR_legitimacy_of_crown_var_100
			country_event = { id = NWportugal.83 hours = 6 }
		}
	}
}

POR_TIM_economic_decline_idea_down = {
	if = {
		limit = { has_idea = POR_TIM_economic_decline_idea_1 }
		swap_ideas = {
			remove_idea = POR_TIM_economic_decline_idea_1
			add_idea = POR_TIM_economic_decline_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_TIM_economic_decline_idea_2 }
		swap_ideas = {
			remove_idea = POR_TIM_economic_decline_idea_2
			add_idea = POR_TIM_economic_decline_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_TIM_economic_decline_idea_3 }
		swap_ideas = {
			remove_idea = POR_TIM_economic_decline_idea_3
			add_idea = POR_TIM_economic_decline_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_TIM_economic_decline_idea_4 }
		remove_ideas = POR_TIM_economic_decline_idea_4
	}
}

POR_fragmented_nation_idea_down = {
	if = {
		limit = { has_idea = POR_fragmented_nation_idea_1 }
		swap_ideas = {
			remove_idea = POR_fragmented_nation_idea_1
			add_idea = POR_fragmented_nation_idea_2
		}
	}
	else_if = {
		limit = { has_idea = POR_fragmented_nation_idea_2 }
		swap_ideas = {
			remove_idea = POR_fragmented_nation_idea_2
			add_idea = POR_fragmented_nation_idea_3
		}
	}
	else_if = {
		limit = { has_idea = POR_fragmented_nation_idea_3 }
		swap_ideas = {
			remove_idea = POR_fragmented_nation_idea_3
			add_idea = POR_fragmented_nation_idea_4
		}
	}
	else_if = {
		limit = { has_idea = POR_fragmented_nation_idea_4 }
		remove_ideas = POR_fragmented_nation_idea_4
	}
}

POR_creating_new_order_check_effect = {
	hidden_effect = {
		if = {
			limit = {
				check_variable = { POR_creating_new_order_var > 99.9 }
				has_country_flag = POR_consolidate_social_reforms_flag
				has_country_flag = POR_install_young_people_in_important_positions_flag
				has_country_flag = POR_blur_class_boundaries_flag
				NOT = { has_country_flag = POR_NWportugal_99_block_flag }
			}
			set_country_flag = POR_NWportugal_99_block_flag
			country_event = NWportugal.99
		}
	}
}

POR_leader_trait_up_effect = {
	POR_francisco_rolao_preto = {
		if = {
			limit = {
				NOT = {
					has_trait = POR_leader_trait_1
					has_trait = POR_leader_trait_2
					has_trait = POR_leader_trait_3
					has_trait = POR_leader_trait_4
					has_trait = POR_leader_trait_5
				}
			}
			add_country_leader_trait = { trait = POR_leader_trait_1 }
		}
		else_if = {
			limit = { has_trait = POR_leader_trait_1 }
			swap_country_leader_traits = { remove = POR_leader_trait_1 add = POR_leader_trait_2 }
		}
		else_if = {
			limit = { has_trait = POR_leader_trait_2 }
			swap_country_leader_traits = { remove = POR_leader_trait_2 add = POR_leader_trait_3 }
		}
		else_if = {
			limit = { has_trait = POR_leader_trait_3 }
			swap_country_leader_traits = { remove = POR_leader_trait_3 add = POR_leader_trait_4 }
		}
		else_if = {
			limit = { has_trait = POR_leader_trait_4 }
			swap_country_leader_traits = { remove = POR_leader_trait_4 add = POR_leader_trait_5 }
		}
	}
}

POR_set_up_character_cw_flags_effect = {
	# Communist
	POR_bento_goncalves = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_popular_front = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_alvaro_cunhal = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_bento_de_jesus_caraca = {		set_character_flag = POR_cw_character_communist_side_flag }
	POR_carolina_loff_da_fonseca = {	set_character_flag = POR_cw_character_communist_side_flag }
	POR_jose_moreira = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_ludgero_pinto_basto = {			set_character_flag = POR_cw_character_communist_side_flag }
	POR_sergio_vilarigues = {			set_character_flag = POR_cw_character_communist_side_flag }
	POR_antonio_dias_lourenco = {		set_character_flag = POR_cw_character_communist_side_flag }
	POR_francisco_miguel_duarte = {		set_character_flag = POR_cw_character_communist_side_flag }
	POR_joaquim_pires_jorge = {			set_character_flag = POR_cw_character_communist_side_flag }
	POR_jose_gregorio = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_candida_ventura = {				set_character_flag = POR_cw_character_communist_side_flag }
	POR_francisco_de_paula_oliveira = {	set_character_flag = POR_cw_character_communist_side_flag }
	POR_julio_de_melo_fogaca = {		set_character_flag = POR_cw_character_communist_side_flag }

	# Anarchist
	POR_emidio_santana = {					set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_serafim_cardoso_lucena = {			set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_manuel_juaquim_de_sousa = {			set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_alexandre_vieira = {				set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_jose_da_silva_santos_scratch = {	set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_aurelio_quintanilla = {				set_character_flag = POR_cw_character_anarchist_side_flag }
	POR_mario_castelhano = {				set_character_flag = POR_cw_character_anarchist_side_flag }
	
	# Republican
	POR_jose_norton_de_matos = {				set_character_flag = POR_cw_character_republican_side_flag }
	POR_joao_tamagnini_barbosa = {				set_character_flag = POR_cw_character_republican_side_flag }
	POR_jose_mendes_cabecadas = {				set_character_flag = POR_cw_character_republican_side_flag }
	POR_augusto_de_vasconcelos = {				set_character_flag = POR_cw_character_republican_side_flag }
	POR_duarte_leite = {						set_character_flag = POR_cw_character_republican_side_flag }
	POR_antonio_maria_da_silva = {				set_character_flag = POR_cw_character_republican_side_flag }
	POR_jose_antonio_simoes_raposo_junior = {	set_character_flag = POR_cw_character_republican_side_flag }
	POR_jaime_cortesao = {						set_character_flag = POR_cw_character_republican_side_flag }
	POR_maria_lamas = {							set_character_flag = POR_cw_character_republican_side_flag }
	
	# Integralist
	POR_francisco_rolao_preto = {				set_character_flag = POR_cw_character_integralist_side_flag }
	POR_jose_hipolito_raposo = {				set_character_flag = POR_cw_character_integralist_side_flag }
	POR_alberto_monsaraz = {					set_character_flag = POR_cw_character_integralist_side_flag }
	POR_duarte_jose_pacheco = {					set_character_flag = POR_cw_character_integralist_side_flag }
	POR_jose_adriano_pequito_rebelo = {			set_character_flag = POR_cw_character_integralist_side_flag }
	POR_jose_ricardo_pereira_cabral = {			set_character_flag = POR_cw_character_integralist_side_flag }
	POR_rodrigo_de_queiros = {					set_character_flag = POR_cw_character_integralist_side_flag }
	
	# Monarchist
	POR_duarte_nuno = {										set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_maria_pia_de_braganca = {							set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_martinho_nobre_de_melo = {							set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_joao_francisco_de_barbosa_azevedo_joao_ameal = {	set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_joao_de_azevedo_coutinho = {						set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_henrique_de_paiva_couceiro = {						set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_rui_coelho = {										set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_eduardo_afonso_viana = {							set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_luis_carlos_de_lima_de_almeida_braga = {			set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_tomas_da_camara = {									set_character_flag = POR_cw_character_monarchist_side_flag }
	POR_jose_maria_do_espirito_santo_de_almeida_correia = {	set_character_flag = POR_cw_character_monarchist_side_flag }
}